---
title: "Statistical Report on Qualified Immunity"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, 
                      fig.width = 6, fig.height = 5)
```

## Setup

```{r load-packages, message = FALSE}
library(tidyverse)
library(knitr)
library(rvest)
library(lubridate)
library(infer)
library(tm)
library(broom)
library(Synth)
library(SCtools)
set.seed(460)
```


```{r load-data}
co_offenses <- read_csv("data/crime.csv")
wa_offenses <- read_csv("data/SPD_Crime_Data__2008-Present.csv")
mn_offenses18 <- read_csv("data/Police_Incidents_2018_PIMS.csv")
mn_offenses19 <- read_csv("data/Police_Incidents_2019.csv")
mn_offenses20 <- read_csv("data/Police_Incidents_2020.csv")
mn_offenses21 <- read_csv("data/Police_Incidents_2021.csv")
tx_offenses19 <- read_csv("data/houston_nibrs_2019.csv")
tx_offenses20 <- read_csv("data/houston_nibrs_2020.csv")
tx_offenses21 <- read_csv("data/houston_nibrs_2021.csv")
cspd <- read_csv("data/Crime_Level_Data.csv")
seattle_uof <- read_csv("data/Use_Of_Force.csv")
mn_uof <- read_csv("data/Police_Use_of_Force.csv")
cspd_uof <- read_csv("data/cspd_uof.csv")
fspd_offenses <- read_csv("data/fspd_offenses.csv")
champaign21 <- read_csv("data/2021_champaign.csv")
champaign20 <- read_csv("data/2020_champaign.csv")
champaign19 <- read_csv("data/2019_champaign.csv")
austin_offenses <- read_csv("data/austin_offenses.csv")
nibrs_conversion <- read_csv("data/NIBRS_OFFENSE_TYPE.csv")
cc_offenses19 <- read_csv("data/cape_coral_2019.csv")
cc_offenses20 <- read_csv("data/cape_coral_2020.csv")
cc_offenses21 <- read_csv("data/cape_coral_2021.csv")
tpd_offenses <- read_csv("data/tallahasee.csv")
cs_offenses <- read_csv("data/college_station.csv")
ny_offenses <- read_csv("data/nypd.csv")
ny_offenses_past <- read_csv("data/nypd_past.csv")
mc_offenses20 <- read_csv("data/mc_offenses.csv")
mc_offenses19 <- read_csv("data/mc_offenses19.csv")
aurora_offenses <- read_csv("data/aurora_crime.csv")

reduced_database_violent <- read_csv("data/database.csv")
synth_denver_violent <- readRDS("data/synth_denver_violent.Rdata")
synth_cspd_violent <- readRDS("data/synth_cspd_violent.Rdata")
synth_aurora_violent <- readRDS("data/synth_aurora_violent.Rdata")
synth_denver_property <- readRDS("data/synth_denver_property.Rdata")
synth_cspd_property <- readRDS("data/synth_cspd_property.Rdata")
synth_aurora_property <- readRDS("data/synth_aurora_property.Rdata")
synth_denver_property2 <- readRDS("data/synth_denver_property2.Rdata") # Placebo by time
synth_cspd_property2 <- readRDS("data/synth_cspd_property2.Rdata") # Placebos by time
synth_aurora_property2 <- readRDS("data/synth_aurora_property2.Rdata") # Placebo by time


placebos7 <- readRDS("data/placebos7.Rdata") # Violent crime version
placebos8 <- readRDS("data/placebos8.Rdata") # Property crime version
placebos9 <- readRDS("data/placebos9.Rdata") # Violent crime version time analysis
placebos10 <- readRDS("data/placebos10.Rdata") # Property crime version time analysis


test_results <- mspe.test(placebos7)$test
test_results2 <- mspe.test(placebos8)$test # set up property crime one here as well


```


```{r basic-wrangling}
reduced_database_violent <- reduced_database_violent %>% 
  mutate(id = as.numeric(id)) %>% 
  mutate(year = as.numeric(year)) 
reduced_database_violent <- as.data.frame(reduced_database_violent)
```

```{r add-dates}
dates <- str_split(co_offenses$FIRST_OCCURRENCE_DATE, " ", simplify = TRUE)
dates <- dates[,1]
year <- str_split(dates, "/", simplify = TRUE)
month <- year[,1]
year <- year[,3]
dates <- tibble(date = dates, month = month, year = year)
co_offenses <- tibble(co_offenses, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my))

co_offenses <- co_offenses %>% 
  mutate(violent = if_else(OFFENSE_CATEGORY_ID == "aggravated-assault" | 
           OFFENSE_CATEGORY_ID == "murder" & 
             OFFENSE_TYPE_ID != "homicide-negligent" | 
           OFFENSE_CATEGORY_ID == "robbery" | 
           OFFENSE_CATEGORY_ID == "sexual-assault", 1, 0)) %>% 
  mutate(property = if_else(OFFENSE_CATEGORY_ID == "arson" |
                              OFFENSE_CATEGORY_ID == "auto-theft" |
                              OFFENSE_CATEGORY_ID == "burglary" | 
                              OFFENSE_CATEGORY_ID == "larceny" |
                              OFFENSE_CATEGORY_ID == "theft-from-motor-vehicle", 
                            1, 0))

daily_totals <- co_offenses %>% 
  filter(IS_CRIME == 1) %>% 
  count(date)

monthly_totals <- co_offenses %>% 
  filter(IS_CRIME == 1) %>% 
  mutate(my = as.Date(my)) %>% 
  count(my)

co_violent <- co_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

co_limited_violent <- co_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

co_limited_property <- co_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

co_monthly_violent <- co_offenses %>% 
  filter(violent == 1) %>% 
  count(my) %>% 
  mutate(time_period = case_when(
   my < as.Date("2020-06-19") ~ "before_qi",
    my >= as.Date("2020-06-19") ~ "after_qi"
  ))

co_monthly_property <- co_offenses %>% 
  filter(property == 1) %>% 
  count(my) %>% 
  mutate(time_period = case_when(
   my < as.Date("2020-06-19") ~ "before_qi",
    my >= as.Date("2020-06-19") ~ "after_qi"
  ))

co_property_totals <- co_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

```

```{r cspd-wrangling}
names(cspd)[4] <- 'date'
names(cspd)[7] <- 'crime_against'
names(cspd)[11] <- 'description'

dates <- str_split(cspd$date, " ", simplify = TRUE)
dates <- dates[,1]
year <- str_split(dates, "/", simplify = TRUE)
month <- year[,1]
year <- year[,3]
dates <- tibble(date = dates, month = month, year = year)
cspd <- cspd[-4]
cspd <- tibble(cspd, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my))

cspd <- cspd %>% 
  mutate(violent = if_else(description == "Aggravated Assault" | 
                             description == "Murder and Non-Negligent Manslaughter" | 
                             description == "Robbery" | 
                             description == "Sexual Assault With An Object" | 
                             description == "Forcible Fondling" |
                             description == "Forcible Rape" | 
                             description == "Forcible Sodomy", 1, 0)) %>% 
  mutate(property = if_else(description == "All Other Larceny" | 
                              description == "Arson" |
                              description == "Burglary/Breaking & Entering" | 
                              description == "Destruction/Damage/Vandalism of Property" | 
                              description == "Motor Vehicle Theft" | 
                              description == "Pocket-Picking" | 
                              description == "Shoplifting" | 
                              description == "Stolen Property Offenses" | 
                              description == "Theft From Building" | 
                              description == "Theft From Coin-Operated Device" | 
                              description == "Theft From Motor Vehicle" | 
                              description == "Theft Of Motor Vehicle Parts" |
                              description == "Purse-Snatching", 1, 0))

cspd_violent <- cspd %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

cspd_monthly_violent <- cspd %>% 
  filter(violent == 1) %>% 
  count(my) %>% 
  mutate(time_period = case_when(
   my < as.Date("2020-06-19") ~ "before_qi",
    my >= as.Date("2020-06-19") ~ "after_qi"
  ))

cspd_property <- cspd %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

cspd_monthly_property <- cspd %>% 
  filter(property == 1) %>% 
  count(my) %>% 
  mutate(time_period = case_when(
   my < as.Date("2020-06-19") ~ "before_qi",
    my >= as.Date("2020-06-19") ~ "after_qi"
  ))
```



```{r add-date-wa}
names(wa_offenses)[3] <- 'date'
names(wa_offenses)[7] <- 'crime_against'
names(wa_offenses)[8] <- 'offense_parent_group'
names(wa_offenses)[9] <- 'offense'
names(wa_offenses)[10] <- 'offense_code'
names(wa_offenses)[6] <- 'group_a_b'

wa_offenses$date <- str_split(wa_offenses$date, " ", simplify = TRUE)[,1] # Get rid of time

dates <- str_split(wa_offenses$date, "/", simplify = TRUE)
month <- dates[,1]
year <- dates[,3]
dates <- tibble(month = month, year = year)
wa_offenses <- tibble(wa_offenses, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my)) # convert to date format

wa_offenses <- wa_offenses %>% 
  mutate(violent = ifelse(offense == "Aggravated Assault" | 
           offense == "Murder & Nonnegligent Manslaughter" | 
           offense == "Rape" | 
           offense == "Robbery" |
           offense == "Sexual Assault With An Object" | 
             offense == "Fondling" | 
             offense == "Sodomy", 1, 0)) %>% 
  mutate(property = ifelse(offense == "All Other Larceny" | 
                             offense == "Arson" | 
                             offense == "Burglary/Breaking & Entering" |
                             offense == "Motor Vehicle Theft" | 
                             offense == "Shoplifting" | 
                             offense == "Stolen Property Offenses" | 
                             offense == "Pocket-picking" |
                             offense == "Theft From Building" | 
                             offense == "Theft From Coin-Operated Machine or Device" | 
                             offense == "Theft From Motor Vehicle" | 
                             offense == "Theft of Motor Vehicle Parts or Accessories" | 
                             offense == "Destruction/Damage/Vandalism of Property" | 
                             offense == "Purse-snatching", 1, 0))
daily_totals_wa <- wa_offenses %>% 
  filter(offense_parent_group != "DRIVING UNDER THE INFLUENCE") %>% 
  filter(date >= as.Date("2016-01-01")) %>% 
  count(date)

monthly_totals_wa <- wa_offenses %>% 
  filter(offense_parent_group != "DRIVING UNDER THE INFLUENCE") %>%
  filter(date >= as.Date("2016-01-01")) %>% 
  count(my) 

wa_monthly_violent <- wa_offenses %>% 
    filter(violent == 1) %>% 
  count(my) %>% 
  rename(wa_n = n)
  

wa_violent <- wa_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

wa_limited_violent <- wa_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

wa_property <- wa_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

wa_limited_property <- wa_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

wa_monthly_property <- wa_offenses %>% 
    filter(property == 1) %>% 
  count(my) %>% 
  rename(wa_n = n)
```

```{r houston-wrangling}
names(tx_offenses19)[2] <- "date"
names(tx_offenses19)[3] <- "hour"
names(tx_offenses19)[4] <- "class"
names(tx_offenses19)[5] <- "description"
names(tx_offenses19)[6] <- "offense_count"
names(tx_offenses20)[2] <- "date"
names(tx_offenses20)[3] <- "hour"
names(tx_offenses20)[4] <- "class"
names(tx_offenses20)[5] <- "description"
names(tx_offenses20)[6] <- "offense_count"
names(tx_offenses21)[2] <- "date"
names(tx_offenses21)[3] <- "hour"
names(tx_offenses21)[4] <- "class"
names(tx_offenses21)[5] <- "description"
names(tx_offenses21)[6] <- "offense_count"

tx_offenses19 <- tx_offenses19 %>% 
  select(-14)

tx_offenses <- full_join(tx_offenses19, tx_offenses20)
tx_offenses <- full_join(tx_offenses, tx_offenses21)

dates <- str_split(tx_offenses$date, "/", simplify = TRUE)
month <- dates[,1]
year <- dates[,3]
dates <- tibble(month = month, year = year)
tx_offenses <- tibble(tx_offenses, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my)) # convert to date format

tx_offenses <- tx_offenses %>% 
  select(date, description, my) %>% 
  mutate(violent = ifelse(description == "Aggravated Assault" | 
           description == "Murder, non-negligent" | 
           description == "Forcible rape" | 
           description == "Robbery" |
           description == "Sexual assault with an object" | 
             description == "Forcible fondling" | 
             description == "Forcible sodomy", 1, 0)) %>% 
  mutate(property = ifelse(description == "All other larceny" | 
                             description == "Arson" | 
                             description == "Burglary, Breaking and Entering" |
                             description == "Theft from motor vehicle" | 
                             description == "Shoplifting" | 
                             description == "Stolen property offenses" | 
                             description == "Pocket-picking" |
                             description == "Theft from building" | 
                             description == "From coin-operated machine or device" | 
                             description == "Motor vehicle theft" | 
                             description == "Theft of motor vehicle parts or accessory" | 
                             description == "Destruction, damage, vandalism" | 
                             description == "Purse-snatching", 1, 0)) 

tx_violent <- tx_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

tx_monthly_violent <- tx_offenses %>% 
    filter(violent == 1) %>% 
  count(my) %>% 
  rename(tx_n = n)

tx_property <- tx_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

tx_monthly_property <- tx_offenses %>% 
    filter(property == 1) %>% 
  count(my) %>% 
  rename(tx_n = n)
```

```{r austin-wrangling}
austin_offenses <- austin_offenses %>% 
  mutate(violent = ifelse(description == "Aggravated Assault" | 
           description == "Murder" | 
           description == "Rape" | 
           description == "Robbery", 1, 0)) %>% 
  mutate(property = ifelse(description == "Auto Theft" | 
                             description == "Burglary" | 
                             description == "Theft", 1, 0))

austin_violent <- austin_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

austin_limited_violent <- austin_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

austin_property <- austin_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

austin_limited_property <- austin_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

austin_monthly_property <- austin_offenses %>% 
    filter(property == 1) %>% 
  count(my) %>% 
  rename(austin_n = n)

austin_monthly_violent <- austin_offenses %>% 
    filter(violent == 1) %>% 
  count(my) %>% 
  rename(austin_n = n)
```


```{r fspd-wrangling}
names(fspd_offenses)[2] <- "date"
names(nibrs_conversion)[2] <- "IBRCode"

nibrs_conversion <- nibrs_conversion %>% 
  select(IBRCode, OFFENSE_NAME, CRIME_AGAINST)

fspd_offenses <- full_join(fspd_offenses, nibrs_conversion, by = "IBRCode")

dates <- str_split(fspd_offenses$date, "/", simplify = TRUE)
month <- dates[,1]
year <- dates[,3]
dates <- tibble(month = month, year = year)
fspd_offenses <- tibble(fspd_offenses, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my)) # convert to date format

fspd_offenses <- fspd_offenses %>% 
  mutate(violent = ifelse(OFFENSE_NAME == "Aggravated Assault" | 
           OFFENSE_NAME == "Murder & Nonnegligent Manslaughter" | 
           OFFENSE_NAME == "Rape" | 
           OFFENSE_NAME == "Robbery" |
           OFFENSE_NAME == "Sexual Assault With An Object" | 
             OFFENSE_NAME == "Fondling" | 
             OFFENSE_NAME == "Sodomy", 1, 0)) %>% 
  mutate(property = ifelse(OFFENSE_NAME == "All Other Larceny" | 
                             OFFENSE_NAME == "Arson" | 
                             OFFENSE_NAME == "Burglary/Breaking & Entering" |
                             OFFENSE_NAME == "Motor Vehicle Theft" | 
                             OFFENSE_NAME == "Shoplifting" | 
                             OFFENSE_NAME == "Stolen Property Offenses" | 
                             OFFENSE_NAME == "Pocket-picking" |
                             OFFENSE_NAME == "Theft From Building" | 
                             OFFENSE_NAME == "Theft From Coin-Operated Machine or Device" | 
                             OFFENSE_NAME == "Theft From Motor Vehicle" | 
                             OFFENSE_NAME == "Theft of Motor Vehicle Parts or Accessories" | 
                             OFFENSE_NAME == "Destruction/Damage/Vandalism of Property" | 
                             OFFENSE_NAME == "Purse-snatching", 1, 0))


daily_totals_fspd <- fspd_offenses %>% 
  filter(date >= as.Date("2016-01-01")) %>% 
  count(date)

monthly_totals_fspd <- fspd_offenses %>% 
  filter(date >= as.Date("2016-01-01")) %>% 
  count(my) 

fspd_monthly_violent <- fspd_offenses %>% 
    filter(violent == 1) %>% 
  count(my) %>% 
  rename(fspd_n = n)

fspd_violent <- fspd_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE) 

add_dates <- co_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, fspd_violent) %>% 
  mutate(n = 0)

fspd_violent <- full_join(antijoin, fspd_violent) %>% 
  arrange(date)

fspd_limited_violent <- fspd_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

add_dates <- co_limited_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, fspd_limited_violent) %>% 
  mutate(n = 0)

fspd_limited_violent <- full_join(antijoin, fspd_limited_violent) %>% 
  arrange(date)

fspd_property <-fspd_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

fspd_limited_property <- fspd_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

fspd_monthly_property <- fspd_offenses %>% 
    filter(property == 1) %>% 
  count(my) %>% 
  rename(fspd_n = n)

```


```{r champaign-wrangling}
il_offenses <- full_join(champaign19, champaign20)
il_offenses <- full_join(il_offenses, champaign21)

names(il_offenses)[1] <- 'date'
names(il_offenses)[2] <- 'description'

year <- str_split(il_offenses$date, "/", simplify = TRUE)
month <- year[,1]
year <- year[,3]
dates <- tibble(month = month, year = year)
il_offenses <- tibble(il_offenses, dates) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(my = paste0(month, "-01-", year)) %>% 
  mutate(my = mdy(my))

il_offenses <- il_offenses %>% 
  mutate(violent = if_else(description == "ARSON" | 
                             description == "ARSON-AGGRAVATED" | 
                             description == "ASSAULT-AGGRAVATED" | 
                             description == "MURDER-FIRST DEGREE" | 
                             description == "MURDER-SECOND DEGREE" |
                             description == "PREDATORY CRIM SEX ASSAULT OF CHILD" | 
                             description == "SEXUAL ABUSE-AGGRAVATED" | 
                             description == "SEXUAL ABUSE-CRIMINAL" |
                             description == "SEXUAL ASSAULT-AGG CRIMINAL" | 
                             description == "SEXUAL EXPLOITATION OF A CHILD" |
                             description == "SEXUAL-ASSAULT-CRIMINAL" |
                             description == "SEXUAL ABUSE-AGGRAVATED" | 
                             description == "VIOL CHILD MURDERER/VIOLENT OFF ACT" |
                             description == "ROBBERY" |
                              description == "ROBBERY-AGGRAVATED" |
                            description == "ROBBERY-ARMED"
                           , 1, 0)) %>% 
  mutate(property = if_else(description == "BURGLARY" | 
                              description == "CRIMINAL DAMAGE GOVT SUPPORT PROP" |
                              description == "BURGLARY FROM MOTOR VEHICLE" | 
                              description == "BURGLARY MOTOR VEH PARTS & ACCESS" | 
                              description == "BURGLARY RESIDENTIAL" | 
                              description == "CRIMINAL DAMAGE TO PROPERTY" | 
                              description == "CRIMINAL DEFACEMENT OF PROPERTY" | 
                              description == "DAMAGE TO CITY PROPERTY" | 
                              description == "DAMAGING PROPERTY" | 
                              description == "POCKET-PICKING" | 
                              description == "RETAIL THEFT" | 
                              description == "THEFT $500 AND UNDER" |
                              description == "THEFT BY LESSEE" |
                              description == "THEFT FROM COIN-OP MACHINE/DEVICE" |
                              description == "THEFT FROM MOTOR VEHICLE" |
                              description == "THEFT GENERALLY" |
                              description == "THEFT OF LOST/MISLAID PROP" |
                              description == "THEFT OF LOST/MISLAID PROPERTY" |
                              description == "THEFT OF MOTOR VEH PARTS & ACCESS" |
                              description == "THEFT OVER $500" |
                              description == "THEFT-AGG IDENTITY" |
                              description == "THEFT-IDENTITY" |
                              description == "THEFT-LABOR OR SERVICES" |
                              description == "THEFT-LOST/MISLAID PROPERTY" |
                              description == "THEFT-MOTOR VEHICLE" |
                              description == "THEFT-RETAIL" |
                              description == "THEFT-AGG IDENTITY", 1, 0))

il_violent <- il_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

add_dates <- co_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, il_violent) %>% 
  mutate(n = 0)

il_violent <- full_join(antijoin, il_violent) %>% 
  arrange(date)

il_monthly_violent <- il_offenses %>% 
    filter(violent == 1) %>% 
  count(my) %>% 
  rename(il_n = n)

il_monthly_property <- il_offenses %>% 
    filter(property == 1) %>% 
  count(my) %>% 
  rename(il_n = n)

il_limited_violent <- il_offenses %>% 
  filter(violent == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

add_dates <- co_limited_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, il_limited_violent) %>% 
  mutate(n = 0)

il_limited_violent <- full_join(antijoin, il_limited_violent) %>% 
  arrange(date)

il_limited_property <- il_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-05-31") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-01") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

add_dates <- co_limited_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, il_limited_property) %>% 
  mutate(n = 0)

il_limited_property <- full_join(antijoin, il_limited_property) %>% 
  arrange(desc(date))



il_property <- il_offenses %>% 
  filter(property == 1) %>% 
  count(date) %>% 
  mutate(time_period = case_when(
    date >= as.Date("2019-06-19") & date < as.Date("2020-06-19") ~ "2019-20",
    date >= as.Date("2020-06-19") & date < as.Date("2021-06-20") ~ "2020-21"
  )) %>% 
  filter(is.na(time_period) == FALSE)

add_dates <- co_violent %>% 
  select(date, time_period)

antijoin <- anti_join(add_dates, il_property) %>% 
  mutate(n = 0)

il_property <- full_join(antijoin, il_property) %>% 
  arrange(date)
```

```{r create-weighted-average}
t1 <- co_violent %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)
t2 <- co_violent %>% 
  filter(time_period == "2020-21") %>%
  rename("p2" = n)

combined_analysis <- tibble(t1, t2) %>% 
  mutate(diff = (p2 - p1) / sum(p1)) %>% 
  mutate(jurisdiction = "Denver") %>% 
  select(diff, jurisdiction, date)

wat1 <- wa_violent %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- wa_violent %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysiswa <- tibble(wat1, wat2) %>% 
  mutate(seattle_diff = (p2 - p1) / sum(p1)) %>% 
  select(seattle_diff, date)

wat1 <- tx_violent %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- tx_violent %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysistx <- tibble(wat1, wat2) %>% 
  mutate(tx_diff = (p2 - p1) / sum(p1)) %>% 
  select(tx_diff)

wat1 <- fspd_violent %>%
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n) 

wat2 <- fspd_violent %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysisfspd <- tibble(wat1, wat2) %>% 
  mutate(fspd_diff = (p2 - p1) / sum(p1)) %>% 
  select(fspd_diff) 

wat1 <- il_violent %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- il_violent %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysisil <- tibble(wat1, wat2) %>% 
  mutate(il_diff = (p2 - p1) / sum(p1)) %>% 
  select(il_diff)

synthetic <- tibble(combined_analysiswa, combined_analysistx, combined_analysisfspd, 
                    combined_analysisil, .name_repair = "universal") %>% 
  mutate(diff = seattle_diff * 0.496466442 + tx_diff * 0.004280705 + fspd_diff * 0.487715311 + 
           il_diff * 0.011537542) %>% 
  mutate(jurisdiction = "Synthetic Control")  %>% 
  select(diff, jurisdiction, date)

combined_synthetic_violent <- full_join(combined_analysis, synthetic)
```



```{r create-weighted-average-property}
t1 <- co_property_totals %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)
t2 <- co_property_totals %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysis <- tibble(t1, t2) %>% 
  mutate(diff = (p2 - p1) / sum(p1)) %>% 
  mutate(jurisdiction = "Denver") %>% 
  select(diff, jurisdiction, date)

wat1 <- wa_property %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- wa_property %>% 
  filter(time_period == "2020-21") %>% 
  rename("p2" = n)

combined_analysiswa <- tibble(wat1, wat2) %>% 
  mutate(seattle_diff = (p2 - p1) / sum(p1)) %>% 
  select(seattle_diff, date)

wat1 <- austin_property %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- austin_property %>% 
  filter(time_period == "2020-21") %>% 
  select(n) %>% 
  rename("p2" = n)

combined_analysistx <- tibble(wat1, wat2) %>% 
  mutate(tx_diff = (p2 - p1) / sum(p1)) %>% 
  select(tx_diff)

wat1 <- fspd_property %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- fspd_property %>% 
  filter(time_period == "2020-21") %>% 
  select(n) %>% 
  rename("p2" = n)

combined_analysisfspd <- tibble(wat1, wat2) %>% 
  mutate(fspd_diff = (p2 - p1) / sum(p1)) %>% 
  select(fspd_diff)

wat1 <- il_property %>% 
  filter(time_period == "2019-20") %>% 
  select(n) %>% 
  rename("p1" = n)

wat2 <- il_property %>% 
  filter(time_period == "2020-21") %>% 
  select(n) %>% 
  rename("p2" = n)

combined_analysisil <- tibble(wat1, wat2) %>% 
  mutate(il_diff = (p2 - p1) / sum(p1)) %>% 
  select(il_diff)

synthetic <- tibble(combined_analysiswa, combined_analysistx, combined_analysisfspd, 
                    combined_analysisil) %>% 
  mutate(diff = seattle_diff * 0.08747524 + tx_diff * 0.6935988 + fspd_diff * 0.00004654831 + 
           il_diff * 0.2188792) %>% # Excluded Houston due to extremely small weight
  mutate(jurisdiction = "Synthetic Control")  %>% 
  select(diff, jurisdiction, date)

combined_synthetic_property <- full_join(combined_analysis, synthetic)
```


## Introduction and Background

Qualified immunity is a court-established doctrine that shields government officials from personal liability for constitutional violations unless the officials violated clearly established laws. After the killing of George Floyd sparked movements against police violence around the country, many activists directed their attention towards qualified immunity as a subject of reform. Activists argued that qualified immunity prevents police officers from being held accountable for excessive uses of force within civil court. Supporters of qualified immunity argued that efforts to limit qualified immunity would prevent police officers from effectively performing their job out of fear of frivolous lawsuits. In this statistical report, we aim to provide preliminary data-driven insights on the effects of recently passed qualified immunity reform on violent and property crime rates in major urban jurisdictions.

Four states have passed measures to limit qualified immunity: Colorado, Connecticut, New Mexico, and New York. Of those states, Colorado passed its reform the earliest, with its measure taking effect June 19, 2020. As a result, we decided to analyze Colorado crime data to determine the effects of qualified immunity on crime rates. In particular, our research question was as follows: Was the passage of qualified immunity reform in Colorado in June of 2020 correlated with significantly larger proportional increases in average daily violent and property crime incidents compared to increases in control jurisdictions? Because statewide data for 2020 and 2021 YTD from Colorado was not publicly available, we further narrowed the scope of our analysis to Denver, Colorado Springs, and Aurora, the three largest jurisdictions within Colorado.

Although we attempt to establish some level of causation in this study through the use of a synthetic control method, we lack the volume of observational data needed to successfully establish causation. In particular, we are missing observations on several key lurking variables, including the effects of COVID on poverty rates in each jurisdiction, 2020 and 2021 census data, community attitudes towards policing as a result of the George Floyd protests, amidst several other control variables. Much of this data will only be released a few years from now, severely limiting the contours of the present analysis. However, due to the prescience of the qualified immunity question and the need for data within the debate, we decided to produce this preliminary report to at least illustrate the plausible effects of qualified immunity on crime rates in Colorado. None of the findings in this report should be interpreted as demonstrating a conclusive causal relationship between qualified immunity reform and crime.

## Overview of Available Data

Many of our Methodology choices can only be understood in the context of the available data and policy context at our disposal. 
We obtained three different types of data from three sources, almost entirely through data released from official sources (with the exception of land area data, which was obtained from a website reporting census data but may have errors). First, we received socioeconomic indicator data from the 2011-2019 American Community Survey estimates as found through the census data website. The predictor data we utilized was organized "by Place," meaning the data was largely aggregated in terms of local unit boundaries (towns, cities, CDPS, etc). This data was collected with the intention of serving as crime predictor data, a use that will be described further in the "Methodology" section. Unfortunately, at the time of the creation of this report, neither 2020 nor 2021 census data had been publicly released. Second, we collected crime rate data by state by city through the UCR Crime in the United States Reports released by the FBI. This data was complete from 2011-2020, and the first 3 quarters of both 2020 and 2021 had been released in the Quarterly UCR Report from roughly 155 large agencies (limited by the number of agencies that reported their crime rates). This data included statistics on jurisdiction population, violent crime numbers, property crime numbers, and numbers for individual crimes (such as forcible rape, nonnegligent homicide/murder, larceny, etc). The quarterly data was unfortunately not disaggregated by quarter, which presented problems later down the line in Methodology A, as the 2020 data incorporated 2 quarters without qualified immunity legislation effect in Denver and 1 quarter after the passage of the qualified immunity legislation. Third, we received incident level crime data by downloading the data from various agency websites and submitting FOIA requests for agencies that had not released their data (such as Champaign Police Department). Several times, these FOIA requests returned data that was unfeasible to use (such as PDF reports of individual crimes), were too costly (totaling greater than $100 for smaller agencies), or were flatly denied on the basis that data was not kept or that state FOIA laws only permitted in-state residents to make FOIA requests (in the case of Clarksville). As a result, the usefulness of FOIA requested data was incredibly limited; however, we incorporated the data that we could obtain using this method into the analysis. The incident-level crime data gave us daily incident crime numbers for various offenses. We categorized incidents into violent and property crimes based on the UCR definitions (Footnote).

In sum, the data that we could obtain was extremely limited in scope, largely due to the combination of limited fiscal/temporal resources, difficulty in obtaining data from police departments, and late releases of census and UCR data. These data limitations then significantly harmed the soundness of the analysis and forced the methodology to deviate significantly from its ideal form. 

## Methodology

In this study, we employed two different methodologies, one to increase the accuracy of the treatment date and the other to increase the total completeness of the data. We have primarily incorporated findings from Methodology A, but findings from Methodology B (performed months before Methodology A was performed) are included in the appendices of this report if they are found to be useful.

In both methodologies, we employed, to varying extents, a synthetic control methodology as described by Abadie in his article "Using Synthetic Controls: Feasibility, Data Requirements, and Methodological Aspects." In a synthetic control method, researchers create a weighted average of jurisdictions and data points with the goal of minimizing the distance between the weighted average and the true jurisdiction's pre-treatment predictor and response values. The synthetic control method has the advantage of systematically identifying the strongest control jurisdictions based on predictor numbers over time, as opposed to manually identifying a geographically close jurisdiction and claiming the existence of sufficient connection to isolate the effects of the policy intervention, thus removing the effects of researcher bias from the analysis. Generally, the synthetic control method is then followed by a series of placebo synthetic control constructions to determine if the post-treatment to pre-treatment MSPE (root mean squared prediction error) ratio for the treated jurisdiction is extreme compared to those of placebo synthetic controls (https://mixtape.scunning.com/synthetic-control.html). If employed successfully, the synthetic control method can successfully prove the existence of a causal connection between different variables.

### Sampling Methodology

Using data provided by the FBI UCR reports, we created a dataset of about 100 jurisdictions and tracked their violent and property crime numbers from 2011 to the first 3 quarters of 2021. Jurisdictions were chosen on the basis of two criteria: First, the jurisdictions' violent and property crime numbers must have been published every year (from 2011 to 2021) by the UCR, including in the UCR's 2021 quarterly crime report. Because the UCR's 2021 quarterly crime report only received numbers from less than 50% of agencies and only published figures from jurisdictions greater than 100,000 in population, the sample of jurisdictions is influenced by some self-selection sampling bias; those jurisdictions that chose not to report figures for one of the years would be automatically excluded. Second, jurisdictions must have been greater than 85K in population according to UCR estimates for every year from 2011 to 2020 (no population data for 2021). This measure is meant to exclude excessively small jurisdictions at the beginning time period that experienced extreme population growth. The number "85,000" was chosen, in part, as an arbitrary value for a jurisdiction that could experience average population growth from 2011 to reach at least 100,000 by 2020. The second selection criterion suffers from some arbitrariness; however, the criterion only excludes 4 jurisdictions from the analysis, each of which were likely too small to provide significant insight. 

After compiling the database of crime numbers, we then compiled a set of yearly socioeconomic indicators from each jurisdiction to serve as predictor values for the 'Synth' package to average when creating a synthetic control. In particular, we chose indicators on the basis of sociological evidence that such indicators could serve as moderately strong predictors of metropolitan violent or property crime rates. Based on the results found in Wells and Weishelt's "Explaining Crime in Metropolitan and Non-Metropolitan Counties," we chose to record jurisdictions' single female-led household percentage, high school education percentage, residential stability (or percent of people living in the same property that they lived in 1 year ago), percentage of population over 18, percentage of population who is white, percentage of population who is self-employed, unemployment rate, median income, child poverty rate, and population density (or population divided by land area). Certain variables recorded in the Wells and Weishelt study were excluded from our analysis because they were either found to be largely non-significant for metropolitan counties in the study (such as South vs. non-South or owner-occupied housing) or were difficult to collect (such as % voting in last election). These indicators were collected by jurisdiction for 2011 to 2019 from the census tables. If a jurisdiction was missing data from any of those years on any of the collected variables, the jurisdiction was excluded from the analysis.

Certain errors occurred when combining census data with UCR data, particularly around the naming schemes of the cities. While the UCR names cities by their given names, the census data often adds addendum names such as "CDP," "city," "town," and others. We attempted to correct for these errors by erasing addendum words from census names (for instance, removing " City" from names as in the case of "Boise City, Idaho" or "Houston City, Texas"). For large jurisdictions (usually above 100000 in population), we further went back and individually corrected names to match. We believe we caught most of these errors, but inevitably some errors slipped through the cracks, leading to randomly lost data. Regardless, we find it unlikely that these random errors significantly hindered our analysis. 

Because we lacked predictor data for 2020 and 2021, we extrapolated predictor data from 2019 to 2020 and 2021. In other words, 2020 and 2021 predictor data (outside of population and population density) were equivalent to 2019 data. Additionally, 2021 population and population density were extrapolated from 2020 population figures. We do not argue that this extrapolation is a fair representation of reality; of course, with COVID and the George Floyd protests of 2020, socioeconomic indicators in 2020 will be far different from those in 2019. Extrapolating will almost certainly skew our pre-treatment predictor averages to some extent; however, we do not think it will invalidate our results entirely. We discuss more in the "Methodology A" section what the implications of this choice will be on our results.

In the end, we had a dataset of 96 jurisdictions, with crime data from 2011 to 2021 and predictor data from 2011 to 2019. In total, our dataset had `r nrow(reduced_database_violent)` observations and 24 variables. In Table 1, we display the first 20 rows of our dataset.

```{r display-dataset}
reduced_database_violent %>% 
  slice(1:20) %>% 
  select(9, 1:8) %>% 
  kable(digits = 3)
```

```{r display-dataset-2}
reduced_database_violent %>% 
  slice(1:20) %>% 
  select(9:17) %>% 
  kable(digits = 3)
```

```{r display-dataset-3}
reduced_database_violent %>% 
  slice(1:20) %>% 
  select(9, 18:24) %>% 
  kable(digits = 3)
```



We decided to split our analysis into violent and property crime analysis for similar reasons as Wells and Weishelt did in their study. There is no evidence that violent and property crime trends are parallel, and ordinarily, property crime numbers would constitute 90% of the total crime rate. Additionally, because the UCR primarily reports property and violent crime numbers, property and violent crime numbers would already be standardized before we began our wrangling process.

### Methodology A: Approximating the Ideal Synthetic Control Methodology

In our first methodology, we analyzed 3 treated jurisdictions (Denver, Colorado Springs, and Aurora) and included roughly 91 control jurisdictions. The treated jurisdictions were chosen on the basis that they were the 3 largest cities within Colorado. We excluded cities in Connecticut, as they passed their own version of the qualified immunity bill around the same time as Colorado, and their law took effect in June of 2021, skewing the 2021 results. We did not need to further exclude New Mexico and New York City, as such jurisdictions were missing data and did not appear in our final dataset, regardless. 

Using the `Synth` package, we created synthetic controls of each of the 3 treated jurisdictions for both violent and property crime rates. We tested a series of synthetic controls to determine the helpfulness of particular predictor variables in the analysis, but we ended up keeping all predictor variables that we collected data on to preserve methodological standardization. Regardless, if our results from removing predictors to improve the synthetic controls are of interest, we have included the results in Appendix 1.

When creating synthetic controls, we included all pretreatment time periods but optimized over 2012 to 2019, allowing the "Synth" function to automatically calculate the pre-treatment MSPE over those 8 years. We specified the pretreatment time period (time.predictors.prior) to be 2011 to 2020. Although 2020 was the year that the qualified immunity law was passed in Colorado, the function we used to calculate MSPE ratios was the "generate.placebos" function from the SCtools package, which included the final pretreatment year and the posttreatment years in calculating the post-treatment MSPE. Thus, although the pretreatment time period was specified to be 2011 to 2020, for functional purposes, 2012 to 2019 were the years relevant to the pre-treatment MSPE calculation, and 2020-2021 were the years relevant to the post-treatment MSPE calculation. Additionally, we specified for the package to employ every available optimization method and choose the best-performing method. We ended by creating 6 different synthetic controls, two for each Colorado jurisdiction, and within each jurisdiction, one for violent crime rates and one for property crime rates.

To determine the significance of our findings, we calculated the "MSPE (mean squared prediction error) ratio" for each of the synthetic controls. In other words, we averaged the squared amount that the synthetic violent or property crime rates differed from the observed violent or property crime rates over the optimized pretreatment time period, given by the `Synth` function as the `loss.v` value. We then averaged the squared amount that the synthetic violent or property crime rates differed from the observed violent or property crime rates over the post-treatment time period. To control for jurisdictions where the synthetic model was not a great fit to begin with, we then divided the post-treatment MSPE by the pre-treatment MSPE, creating an MSPE ratio. Theoretically, if the intervention had a significant effect on the property or violent crime rates in the treated jurisdictions, we should see significant increases in crime rates in 2020 and 2021 exceeding those of the synthetic control, and thus, the MSPE ratio of those jurisdictions should be high. However, because there is no objective metric for what a "high enough" MSPE ratio is, we further created placebo synthetic controls for every control jurisdiction in the dataset and calculated MSPE ratios for each placebo synthetic control. (FOOTNOTE) If the MSPE ratio of the treated jurisdiction was greater than 95% of placebo MSPE ratios, we concluded that the MSPE ratio of the treated jurisdiction was high enough to be statistically significant. The interpretations of such a conclusion will be further discussed in the "Results" section. 

The synthetic control methodology that we employed suffered from several limitations. First, as noted in the "Sampling Methodology" section, we extrapolated predictor values from 2019 to 2020 and 2021. This biased the averages used when constructing the synthetic control. Since 2020 was included in the pretreatment time section, we functionally doubled the role of 2019 in calculating predictor averages for the treated jurisdiction for the synthetic jurisdiction to emulate. We do not believe this should, alone, invalidate our analysis however. Since the 2020 predictors data is only used in calculating an overall average of the predictors that the synthetic jurisdiction should approximate - and not to serve as predictors that should be held constant from year to year to isolate the effects of the intervention - the extrapolated 2020 data would only cause the synthetic control methodology to create weighted averages that matched treated jurisdictions' 2019 data above other older years. For example, if researchers attempted to control the 2020 and 2021 MSPE for the predictor variables using the 2019 data, such an effort would clearly be invalid, as 2019 unemployment and child poverty rates clearly cannot be used to adjust for 2020 and 2021 data. However, because we employ a synthetic control methodology and do not calculate MSPEs differently based on predictor values, we do not suffer from such limitations. The methodology merely averages the predictor values of the treated jurisdiction over the pretreatment time period for the synthetic control to match, but does not attempt to hold such predictors constant from year to year or control for yearly shifts in those predictors. Thus, the skew created by such a flaw is minimal. 

Second, the time of the treatment is not effectively accounted for by the synthetic control methodology. The passage of the qualified immunity bill in Colorado occurred in the middle of 2020; however, we do not have quarterly data by which we could isolate the 2 quarters of 2020 without the influence of the policy intervention from the 2 quarters influenced by the intervention. Instead, we simply sort 2020 and 2021 as broadly falling under the post-treatment time frame, operating on the assumption that if the qualified immunity legislation affected violent and property crime rates in the Colorado jurisdictions, the increase in violent and property crime rates for the whole of 2020 would be greater than those of treated jurisdictions. Unfortunately, such an assumption is not necessarily true, as 2020 introduced a series of different factors, ranging from COVID to the George Floyd protests, each of which influenced  jurisdictions' crime rates in unknown ways. As a result, we are hesitant to derive a causal conclusion from any of our analysis; our findings could very well be interpreted in several different lights, including that COVID impacted Colorado jurisdictions' crime rates harder than other jurisdictions, or that police agencies in Colorado passed 2020 policies different from those of other jurisdictions. We attempt to solve this problem in Methodology B at the cost of other significant methodological limitations.

Third, in an ideal synthetic control, we would have a wealth of years both before and after the treatment to evaluate. Unfortunately, due to the recency of the legislation and the inability to divide years into quarterly data, we only had a total of 2 post-treatment time periods to evaluate. This may limit our insights, as a single year of increased property or violent crime rates in one of the treated jurisdictions would skew the mean post-treatment MSPE substantially, even if such a year occurred merely from chance. Placebo testing should be able to diminish the influence of chance in the analysis, but having more post-treatment time periods to calculate the MSPE would allow the analysis to be more reliable.

### Methodology B: Synthetic Control as Comparative Case Study Selection

Our second methodology was employed before the release of 2020 and 2021 data by the UCR and was meant to serve as a workaround to normal synthetic analysis. The second methodology was also performed in August of 2021 with only a few updates since then, limiting the scope of the data. As a result, the second methodology suffers from severe limitations, many of which could invalidate the analysis entirely. Regardless, we include the results from Methodology B in the appendices in case they are found to be useful in their treatment date precision and high jurisdiction inclusion that Methodology A lacks.

In our second methodology, we examined violent and property crime rates in Denver only. FOOTNOTE ON COLORADO SPRINGS In selecting possible control jurisdictions, we waived the requirements for 2020 and 2021 crime data, as such data was not relevant for the analysis. We additionally only filtered for jurisdictions greater than 50000 in population, as we only had access to a small number of time periods but an enormous sample of jurisdictions within the donor pool. We removed population density from the analysis and relied on population alone to serve as the "population" level statistic. This led to many nonsimilar jurisdictions being included in the analysis, significantly increasing the potential for bias. In total, we had roughly 530 jurisdictions in the donor pool when constructing the synthetic control.

To account for the lack of 2020 and 2021 date and to increase the precision of the treatment dates, we used the synthetic control methodology to identify similar jurisdictions to Denver or Colorado Springs and to provide weights for some of those jurisdictions. We optimized the synthetic controls for 2016 to 2019 to obtain a synthetic control that could follow the most recent trends in both Denver and colorado Springs. We then identified the top 5 jurisdictions with the highest weights and reran the synthetic control model with only those jurisdictions to recalculate the weights, relying on the premise that the synthetic of the top 4 or 5 jurisdictions that comprise a majority weight in the full synthetic control would be similar enough to the treated jurisdictions to analyze. With those identified control jurisdictions, we submitted requests for incident-level crime data from those departments for 2019-2021. When those requests were either unanswered or denied (as in the case of Ann Arbor Police Department), we removed the city from the synthetic control model and reran the model until we obtained at least three police departments with accessible incident level crime data.

We subdivided all 2019-2021 incident-level crime data into property and violent crimes based on UCR definitions. In particular, murder and nonnegligent homicide, aggravated assault, robbery, and forcible rape (including sexual assault with an object, fondling, and forcible sodomy) were identified as violent crimes. We categorized larceny charges, burglary, damage/destruction of property, arson, shoplifting, pocket-picking, and motor vehicle theft charges as property crimes. We calculated the daily numbers of violent and property offenses for June of 2019 to June of 2020 (before qualified immunity reform) and June of 2020 to June of 2021 (after qualified immunity reform) in control and treated jurisdictions. We then subtracted the daily numbers of violent and property offenses in the 2019-20 time period from the 2020-21 time period and divided by the total number of violent or property offenses in the 2019-20 time period to make the daily numbers of violent and property crimes proportionate to each jurisdiction's respective crime numbers. Finally, we created a bootstrapped null distribution assuming no true difference between the daily increases of the synthetic jurisdiction compared to Denver or Colorado Springs and calculated a p-value based on the probability of observing the real difference or greater between Denver/Colorado Springs and the respective synthetic control difference based on the null distribution.

This methodology had a few critical limitations. First, because of the lack of 2020 and 2021 census data, we could only identify jurisdictions similar to either Denver or Colorado Springs until 2019 which is no guarantee that those similarities in control predictors continued until 2020 and 2021. In addition, since we did not have access to UCR data for 2020 and 2021, we had to use 2011-2019 weights in 2020 and 2021 calculations, which extrapolate beyond the capabilities of the synthetic control. Second, because of the several denied requests (especially from Ann Arbor and Clarksville Police Departments), we were forced to rely partially on convenience sampling in order to successfully carry out the study. Third, because we needed to determine if the increases between the 2019-20 time period and 2020-21 time period were significantly greater than increases in control jurisdictions, we were forced to employ a test where we subtracted daily crimes in one time period from daily crimes in another time period. This method may have substantially exaggerated the standard deviation of violent and property crimes, since daily fluctuations in crime do not remain constant over the course of a year. The test may have been more successful on a monthly level, but we did not have enough monthly difference data to successfully arrive at statistical conclusions through simulation. Fourth, because we had to standardize the daily crime numbers by dividing crime numbers from some relative figure for each jurisdiction (in this case, the total number of offenses in the 2019-20 time period), smaller jurisdictions disproportionately influenced the variance of the synthetic control, since daily fluctuations of 1-2 offenses were much greater when standardized compared to larger jurisdictions. Fifth, the methodology misuses the synthetic control methodology to identify 4-5 jurisdictions that comprise the majority weight of the main jurisdiction, but the synthetic control methodology is only intended to weight jurisdictions in a manner that creates an average jurisdiction matching the treated one, not to identify jurisdictions that are most similar to the treated jurisdiction. As a result, the jurisdictions we chose based on the synthetic control were often dramatically different from the treated jurisdiction (such as Champaign, IL and Fort Smith, AR, both of which were incredibly small jurisdictions). Finally, because we included both excessively small and excessively large jurisdictions, we did not filter the dataset beforehand to only include jurisdictions that were somewhat similar to Denver, skewing the synthetic averages towards the extremes.

The results of this methodology, in their entirety, will be described in Appendix 2.

## Exploratory Data Analysis

### Outcome Variable Comparisons

```{r fig.height = 4, fig.width = 5}

y_int <- co_monthly_violent %>% 
  filter(time_period == "before_qi") %>% 
  summarise(max = max(n)) %>% 
  pull()

ggplot(co_monthly_violent, aes(x = my, y = n, fill = time_period)) + 
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("red", "black")
  ) + 
  theme(legend.position = "none") + 
  labs(title = "Monthly Violent Crime Numbers in Denver 2016-2021", 
       x = "Date", 
       y = "Number of Reported Incidents") + 
  geom_hline(yintercept = y_int + 10, lty = 2) +
  theme(text = element_text(size = 9))
```

```{r monthly-prop-denver, fig.height = 4, fig.width = 5}
y_int <- co_monthly_property %>% 
  filter(time_period == "before_qi") %>% 
  summarise(max = max(n)) %>% 
  pull()

ggplot(co_monthly_property, aes(x = my, y = n, fill = time_period)) + 
  geom_bar(stat = "identity") + 
  scale_fill_manual(values = c("red", "black")
  ) + 
  theme(legend.position = "none") + 
  labs(title = "Monthly Property Crime Numbers in Denver 2016-2021", 
       x = "Date", 
       y = "Number of Reported Incidents") + 
  geom_hline(yintercept = y_int + 50, lty = 2) +
  theme(text = element_text(size = 9))
```

```{r monthly-violent-cspd, fig.height = 4, fig.width = 5}
y_int <- cspd_monthly_violent %>% 
  filter(time_period == "before_qi") %>% 
  summarise(max = max(n)) %>% 
  pull()

ggplot(cspd_monthly_violent, aes(x = my, y = n, fill = time_period)) + 
  geom_bar(stat = "identity") + 
  scale_fill_manual(values = c("red", "black")
  ) + 
  theme(legend.position = "none") + 
  labs(title = "Monthly Violent Crime Numbers in Colorado Springs 2016-2021", 
       x = "Date", 
       y = "Number of Reported Incidents") + 
  geom_hline(yintercept = y_int + 10, lty = 2) +
  theme(text = element_text(size = 9))
```

```{r monthly-property-cspd, fig.height = 4, fig.width = 5}
y_int <- cspd_monthly_property %>% 
  filter(time_period == "before_qi") %>% 
  summarise(max = max(n)) %>% 
  pull()

ggplot(cspd_monthly_property, aes(x = my, y = n, fill = time_period)) + 
  geom_bar(stat = "identity") + 
  scale_fill_manual(values = c("red", "black")
  ) + 
  theme(legend.position = "none") + 
  labs(title = "Monthly Property Crime Numbers in Colorado Springs 2016-2021", 
       x = "Date", 
       y = "Number of Reported Incidents") + 
  geom_hline(yintercept = y_int + 50, lty = 2) +
  theme(text = element_text(size = 9))
```

## Testing and Results

In this section, we will discuss the synthetic control diagnostics and MSPE test results for each of the 6 synthetic controls. Note that both population and population density were included as predictors, as both of them were found to be important by model selection.

### Synthetic Controls for Violent Crime

#### Denver: 

We began with Denver, the largest jurisdiction in Colorado. Below, we included the graph comparing the violent crime rates of the synthetic jurisdiction and Denver itself. 

```{r prep-denver-violent}
denver_violent_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 24, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
         
```

```{r synth-denver-violent, results = "hide", eval = FALSE}
synth_denver_violent <- synth(denver_violent_prep, optimxmethod = "All")
```

```{r path-plot-denver}
path.plot(synth.res = synth_denver_violent,
dataprep.res = denver_violent_prep,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

The synthetic control is relatively strong with a pre-treatment MSPE value of `synth_denver_violent$loss.v`, as computed by the `Synth` package over the years of 2012-2019. As expected, synthetic Denver roughly follows the trends of Denver up until about 2016. In 2017, observed Denver's violent crime rate increases as the synthetic's decreases, causing observed Denver's violent crime rates to be greater than those of Synthetic Denver for the next few years up until 2021. The trends on the graph are not perfectly parallel prior to 2016. Past 2016, however, Denver's observed violent crime rate is parallel to the synthetic control's violent crime rate.

```{r create-table}
denver_table <- synth.tab(dataprep.res = denver_violent_prep, 
                             synth.res = synth_denver_violent)
denver_table$tab.pred %>% 
  kable(digits = 3)
```

```{r display-denver-table}
denver_table$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  select(w.weights, unit.names) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

Table 2 indicates that the synthetic control matches the predictor values of observed Denver almost perfectly, even in terms of population and population density despite the sample means significantly deviating from those of Denver. In the weights, we can see that the majority of synthetic Denver is comprised of Oklahoma City, Houston, and Alexandria, although several cities possess nonzero weights. In this way, our synthetic control is distinct from the synthetic control used within Alberto Abadie's research on the Basque region, as their synthetic control only weighted 2 other regions and assigned zero weights to the rest of the regions.

```{r}
test_results_denver_lim <- mspe.test(placebos7, discard.extreme = TRUE,
                                     mspe.limit = 5)$test
test_results <- mspe.test(placebos7)$test

mspe1 <- test_results %>% 
  filter(unit == "Denver, Colorado") %>% 
  pull(MSPE.ratios)

test_results_denver_lim <- test_results_denver_lim %>% 
  filter(unit != "Denver, Colorado")

names(test_results_denver_lim)[1] <- "ratios"
n <- test_results_denver_lim %>% 
  filter(ratios >= mspe1) %>% 
  nrow()
p1 <- n / nrow(test_results_denver_lim)  # Find p-value again
p1
```


After calculating over 90 different placebo synthetic controls, we found that Denver's MSPE ratio was nonsignificant at the 1%, 5%, or 10% level. In particular, we found that when excluding jurisdictions with pre-treatment MSPEs more than 5x greater than the pre-treatment MSPE of Denver, more than 11% of the placebo synthetic controls had MSPE ratios greater than that of Denver. However, Denver's data is still relatively extreme; if we instead chose to run a one-sided test or excluded outliers from the placebos, it is very plausible that Denver's violent crime rates would be extreme. Nonetheless, based on our assigned thresholds, the data does not provide sufficient evidence to indicate that Denver's violent crime rate in 2020 or 2021 could not have resulted purely from chance.

#### Colorado Springs

```{r cspd-violent-prep}
cspd_violent_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "owner_occupied",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income", 
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 19, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
         
```


```{r synth-cspd-violent, results = "hide", eval = FALSE}
synth_cspd_violent <- synth(cspd_violent_prep, optimxmethod = "All")
```

```{r plot-cspd}
path.plot(synth.res = synth_cspd_violent,
dataprep.res = cspd_violent_prep,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Colorado Springs, CO","Synthetic Colorado Springs")
)
```

```{r create-table-cspd}
cspd_table <- synth.tab(dataprep.res = cspd_violent_prep, 
                             synth.res = synth_cspd_violent)
cspd_table$tab.pred %>% 
  kable(digits = 3)
```

```{r display-cspd-table}
cspd_table$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  select(w.weights, unit.names) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

The synthetic control for Colorado Springs is very strong, with a pre-treatment MSPE of `r synth_cspd_violent$loss.v`, lower than that of Denver. Similar to Denver, per table x, Colorado Springs' predictor values match relatively well with those of the synthetic jurisdiction, with the exceptions of racial homogeneity which is about 10% off and owner-occupied housing which is about 3% off. Nevertheless, given that the synthetic control tracks Colorado Springs relatively thoroughly, we find it appropriate to proceed with the given model.

```{r calculate-mspe-cspd-violent}
est <- cspd_violent_prep$Y0plot %*% synth_cspd_violent$solution.w
est <- est[c(10, 11)]
real <- reduced_database_violent %>% 
  filter(NAME == "Colorado Springs, Colorado" & year >= 2020) %>% 
  select(violent_crime_rate) %>% 
  pull()

mspe2 <- cvTools::mspe(est, real) / synth_cspd_violent$loss.v
mspe2 <- mspe2[1]
l_cspd <- synth_cspd_violent$loss.v
l_cspd <- l_cspd[1]

extremes <- which(placebos7$mspe.placs >= 5 * l_cspd) # l = CSPD loss.v value
unit.names <- placebos7$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_cspd_lim <- test_results %>% 
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_cspd_lim)[1] <- "ratios"
n <- test_results_cspd_lim %>% 
  filter(ratios >= mspe2) %>% 
  nrow()
p2 <- n / nrow(test_results_cspd_lim)  # Find p-value again
p2
```

Using the same placebos generated for Denver, we found that Colorado Springs' MSPE ratio of `r round(mspe2, 3)` was smaller than 70% of placebo jurisdictions after removing placebo jurisdictions with pre-treatment MSPEs 5x greater than Colorado Springs'. The data does not provide sufficient evidence to indicate that Colorado Springs' violent crime rates in 2020 and 2021 were significantly different from those of control jurisdictions.

#### Aurora

```{r}
aurora_violent_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "owner_occupied",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 4, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
         
```


```{r results = "hide", eval = FALSE}
synth_aurora_violent <- synth(aurora_violent_prep, optimxmethod = "All")
```

```{r}
path.plot(synth.res = synth_aurora_violent,
dataprep.res = aurora_violent_prep,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Aurora, CO","Synthetic Aurora")
)
```

```{r gaps-plot-aurora}

gaps.plot(synth.res = synth_aurora_violent,
dataprep.res = aurora_violent_prep,
Ylab = "Violent Crime Rate Gaps",
Xlab = "Year"
)
```

```{r create-table-aurora}
aurora_table <- synth.tab(dataprep.res = aurora_violent_prep, 
                             synth.res = synth_aurora_violent)
aurora_table$tab.pred %>% 
  kable(digits = 3)
```

```{r display-aurora-table}
aurora_table$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  select(w.weights, unit.names) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

Despite the fact that Aurora's synthetic control matches its predictor values extremely well, the graph of Aurora's synthetic control makes it clear that Aurora's synthetic control is a weak fit for the data. While Aurora experiences a large uptick in violent crime in 2016 and 2017, the synthetic control experiences no such uptick. Aurora's pretreatment MSPE is also extremely high with a value of `r round(synth_aurora_violent$loss.v, 3)`, almost 20 times that of Colorado Springs. We find it unlikely that insights derived from this synthetic control will be helpful, but we run the significance test regardless.


```{r p-value-aurora}
est <- aurora_violent_prep$Y0plot %*% synth_aurora_violent$solution.w
est <- est[c(10, 11)]
real <- reduced_database_violent %>% 
  filter(NAME == "Aurora, Colorado" & year >= 2020) %>% 
  select(violent_crime_rate) %>% 
  pull()

mspe3 <- cvTools::mspe(est, real) / synth_aurora_violent$loss.v
mspe3 <- mspe3[1]
l <- synth_aurora_violent$loss.v
l <- l[1]

extremes <- which(placebos7$mspe.placs >= 5 * l) # l = Aurora loss.v value 
unit.names <- placebos7$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_aurora_lim <- test_results %>% 
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_aurora_lim)[1] <- "ratios"
n <- test_results_aurora_lim %>% 
  filter(ratios >= mspe3) %>% 
  nrow()
p3 <- n / nrow(test_results_aurora_lim)  # Find p-value again
p3
```

We find that when calculating the MSPE ratio of Aurora and comparing with placebos, the MSPE ratio is not significant at the 1%, 5%, or 10% level. When excluding placebos with pre-treatment MSPEs over 5x greater than that of Aurora, about 11.9% of the placebo synthetic controls have MSPE ratios greater than that of Aurora. It is plausible that if we further examined whether each placebo synthetic control's large MSPE ratio was from higher than expected violent crime rates or lower than expected violent crime rates (functionally turning the test into a one-sided test), Aurora's increase may become significant. However, given that Aurora's synthetic control is already so weak, we do not feel it would be valuable to conduct such an analysis.

#### Placebos for Violent Crimes

As we noted earlier, we generated over 90 different placebo synthetic controls with the same settings as the original synthetic control and compiled all the MSPE ratios from each placebo synthetic control into a single dataset for significance testing. We would like to take a moment to comment on these placebos.

Below, we visualized these placebos' MSPE ratios and noted their summary statistics.

```{r summary-stats-placebos}
test_results %>% 
  summarise(mean = mean(MSPE.ratios), 
            sd = sd(MSPE.ratios), 
            median = median(MSPE.ratios)) %>% 
  kable(digits = 3)
```

```{r}
test_results %>% 
  filter(unit != "Denver, Colorado") %>% 
ggplot(aes(x = MSPE.ratios)) + 
  geom_histogram(color = "black") +
  xlim(0, 220) +
  ylim(0, 20) + 
  geom_vline(xintercept = mspe3, color = "red") + 
  geom_vline(xintercept = mspe2, color = "steelblue") + 
  geom_vline(xintercept = mspe1) + 
  labs(title = "Distribution of Placebo MSPE Ratios", 
       x = "MSPE Ratios", 
       y = "Count")# Denver's value
```

As the histogram displays, most placebo MSPE ratios are centered at 0-10 with the exception of three placebo MSPE ratios above 80 Those MSPE ratios represent Evansville and Manchester and likely occurred from an exceptionally good fit with the data in pretreatment years with some declining fit in 2020. The outlier will be further explored in Appendix 3; however, we do not see a good reason to remove the outlier, as removing the outlier would not change the significance of any of our results.

Re-visualizing without outliers and reducing the binwidth to further detail the smaller MSPE ratios in the spectrum, we arrive at the second graph below.

```{r summary-stats-placebos-2}
test_results %>% 
  filter(MSPE.ratios <= 60) %>% 
  summarise(mean = mean(MSPE.ratios), 
            sd = sd(MSPE.ratios), 
            median = median(MSPE.ratios)) %>% 
  kable(digits = 3)
```

```{r}
test_results %>% 
  filter(unit != "Denver, Colorado") %>% 
ggplot(aes(x = MSPE.ratios)) + 
  geom_histogram(color = "black", binwidth = 0.50) +
  xlim(0, 45) +
  ylim(0, 20) + 
  geom_vline(xintercept = mspe3, color = "red") + 
  geom_vline(xintercept = mspe2, color = "steelblue") + 
  geom_vline(xintercept = mspe1) + 
  labs(title = "Distribution of Placebo MSPE Ratios", 
       x = "MSPE Ratios", 
       y = "Count") # Denver's value
```

As we can see, Colorado Springs is squarely within the center of the distribution. Aurora and Denver's MSPE ratios are larger than most of the MSPE ratios within the dataset, but the ratio is still smaller than enough placebos to not constitute statistically significant evidence.

We display these placebos to give the reader an idea of what synthetic controls we ended up creating, any outliers or flaws within the synthetic controls, as well as where the treated jurisdictions lie on the distribution.

#### Overall Results for Violent Crime

In terms of violent crime, we created three different synthetic controls, one for each of the three treated jurisdictions in Colorado. After generating over 90 placebo MSPE ratios, we found that the MSPE ratios of Denver, Colorado Springs, and Aurora were not large enough to constitute statistically significant evidence that violent crime rates in those areas were significantly different from violent crime rates in control jurisdictions post-treatment. The synthetic controls were strong fits for Denver and Colorado Springs, but the synthetic control was extremely weak in the context of Aurora.

### Property Crime

Our property crime results varied significantly from our violent crime results in terms of the significance of our findings. Just like in the case of violent crime, we created three synthetic controls, one for each of three treated jurisdictions. All 3 synthetic controls were at least moderate fits with the data, with significant variation in how well the synthetic controls fit based on treated jurisdiction. 

#### Denver

```{r results = "hide"}
denver_property_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 24, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)

```

```{r, eval = FALSE}
synth_denver_property <- synth(denver_property_prep, optimxmethod = "All")
```

```{r}
path.plot(synth.res = synth_denver_property,
dataprep.res = denver_property_prep,
Ylab = c("Property Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

```{r gaps-plot-denver-property}
gaps.plot(synth.res = synth_denver_property,
dataprep.res = denver_property_prep,
Ylab = "Property Crime Rate Gaps",
Xlab = "Year"
)
```

```{r}
denver_prop_tables <- synth.tab(dataprep.res = denver_property_prep, 
                                synth.res = synth_denver_property)
denver_prop_tables$tab.pred %>% 
  kable(digits = 3)
denver_prop_tables$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

As seen in Figures ____ (path and gaps plots), the synthetic control is not an exceptional fit for the Denver data. In particular, while the synthetic control's property crime rate steadily decreases, Denver's property crime rate has the opposite trend from 2014. Notably, however, the gaps between Denver and the synthetic control's property crime rates are not especially large until the time periods post-treatment (2020 and 2021), where Denver has an immense increase in property crime rates that is not at all followed by the synthetic control. 

In terms of predictors, Table ___ displays that the synthetic control does a good job of creating a synthetic jurisdictions with predicotrs that match the observed Denver well for every predictor. Based on this, we believe that the synthetic control fits well enough to run a statistical significance analysis with meaningful insights. It is important to note, however, that the conclusions reached by the significance analysis are, of course, limited by the fact that the synthetic control and Denver had opposite crime trends even prior to treatment, even if such crime trends did not reach the magnitude of difference post-treatment.


```{r}
test_results_denver_lim <- mspe.test(placebos8, discard.extreme = TRUE,
                                     mspe.limit = 5)$test
mspe4 <- test_results2 %>% 
  filter(unit == "Denver, Colorado") %>% 
  pull(MSPE.ratios)

test_results_denver_lim <- test_results_denver_lim %>% 
  filter(unit != "Denver, Colorado")

names(test_results_denver_lim)[1] <- "ratios"
n <- test_results_denver_lim %>% 
  filter(ratios >= mspe4) %>% 
  nrow()
p4 <- n / nrow(test_results_denver_lim)  # Find p-value again
p4
```


After generating over 90 placebos, we found the MSPE ratio of Denver to be statistically significant. In particular, after discarding jurisdictions with pre-treatment MSPEs greater than 5x that of Denver's, we found that Denver's MSPE ratio of `r round(mspe4, 3)` was extremely high, only exceeded by Madison, Wisconsin and McAllen, TX. Although not significant at the 1% level, such a finding is significant at the 5% and 10% levels. The data does provide sufficient evidence to indicate that Denver's property crime rate in 2020 and 2021 is significantly greater than those of control jurisdictions and makes it unlikely that Denver's heightened property crime rate merely resulted from chance.

#### Colorado Springs

```{r results = "hide"}
cspd_property_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                 "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 19, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
```


```{r, results = "hide", eval = FALSE}
synth_cspd_property <- synth(cspd_property_prep, optimx = "All")
```

```{r}
path.plot(synth.res = synth_cspd_property,
dataprep.res = cspd_property_prep,
Ylab = c("Property Crime Rates"),
Xlab = c("Year"),
Legend = c("Colorado Springs, CO","Synthetic Colorado Springs")
)
```

```{r gaps-plot-2-cspd}

gaps.plot(synth.res = synth_cspd_property,
dataprep.res = cspd_property_prep,
Ylab = "Property Crime Rate Gaps",
Xlab = "Year", 
Ylim = c(-1000, 1000)
)
```

```{r}
cspd_prop_tables <- synth.tab(dataprep.res = cspd_property_prep, 
                                synth.res = synth_cspd_property)
cspd_prop_tables$tab.pred %>% 
  kable(digits = 3)
cspd_prop_tables$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

Unlike in the case of Denver, Colorado Springs' synthetic control is an exceptionally good fit to the data. With a pretreatment MSPE of only `r round(synth_cspd_property$loss.v, 3)` (note that because we are using property crime rates, numbers are expected to be much higher than in the case of violent crime rates), the synthetic control follows Colorado Springs' trend exceptionally well until about 2019. From 2019-2021, Colorado Springs had a slightly higher property crime rate than its synthetic control. On the level of predictors, synthetic Colorado Springs deviates from Colorado Springs' predictor values in owner-occupied housing, child poverty, and racial homogeneity, with child poverty being an especially important predictor. This likely limits the extent to which the synthetic control can track Colorado Springs' crime trends effectively, but given the pretreatment fit, a statistical significance analysis likely would still be meaningful.

```{r p-value-cspd-2}
est2 <- cspd_property_prep$Y0plot %*% synth_cspd_property$solution.w
est2 <- est2[c(10, 11)]
real <- reduced_database_violent %>% 
  filter(NAME == "Colorado Springs, Colorado" & year >= 2020) %>% 
  select(property_crime_rate) %>% 
  pull()

mspe5 <- cvTools::mspe(est2, real) / synth_cspd_property$loss.v
mspe5 <- mspe5[1]

l_cspd <- synth_cspd_property$loss.v
l_cspd <- l_cspd[1]
extremes <- which(placebos8$mspe.placs >= 5 * l_cspd) # l = Aurora loss.v value 
unit.names <- placebos8$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_cspd_lim <- test_results2 %>% 
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_cspd_lim)[1] <- "ratios"
n <- test_results_cspd_lim %>% 
  filter(ratios >= mspe5) %>% 
  nrow()
p5 <- n / nrow(test_results_cspd_lim)  # Find p-value again
p5
```

Using significance testing, we found that Colorado Springs' MSPE ratio of about 7.7, although higher than the average, was not statistically significant at any of the 3 levels after removing jurisdictions with pretreatment MSPEs more than 5x greater than that of Colorado Springs. Roughly 45% of placebo jurisdictions had MSPE ratios greater than the one in Colorado Springs. Thus, the data does not provide sufficient evidence to indicate that Colorado Springs' different property crime rates from control jurisdictions could not have resulted simply from chance.

#### Aurora

```{r aurora-prop-prep, results = "hide"}
aurora_property_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 4, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
```


```{r aurora-synth-property, results = "hide", eval = FALSE}
synth_aurora_property <- synth(aurora_property_prep, optimxmethod = "All")
```

```{r plots-aurora}
path.plot(synth.res = synth_aurora_property,
dataprep.res = aurora_property_prep,
Ylab = c("Property Crime Rates"),
Xlab = c("Year"),
Legend = c("Aurora, CO","Synthetic Aurora")
)

gaps.plot(synth.res = synth_aurora_property,
dataprep.res = aurora_property_prep,
Ylab = "Property Crime Rate Gaps",
Xlab = "Year"
)
```

```{r tables-aurora}
aurora_prop_tables <- synth.tab(dataprep.res = aurora_property_prep, 
                                synth.res = synth_aurora_property)
aurora_prop_tables$tab.pred %>% 
  kable(digits = 3)


aurora_prop_tables$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  slice(1:20) %>% 
  kable(digits = 3)
```

Unlike in the case of the Aurora violent crime synthetic control, the Aurora property crime synthetic control is a moderate fit to the data. Per figure ____, the gaps between Aurora's property crime rate and synthetic Aurora's property crime rates are less than 500 until the treatment year. Similar to Denver's property crime synthetic control, Aurora's property crime synthetic control suffers from opposite trends; while the synthetic control's property crime rates are steadily decreasing every year from 2011, Aurora's property crime rates remain steady until its increase in 2020. However, Aurora's predictors are well-matched by the synthetic control, and Aurora's pretreatment MSPE of `r round(synth_aurora_property$loss.v, 3)` is substantially lower than Denver's property crime pretreatment MSPE. Overall, the fit with the data is strong enough to derive some meaningful insights.

```{r p-value-aurora-2}
est <- aurora_property_prep$Y0plot %*% synth_aurora_property$solution.w
est <- est[c(10, 11)]
real <- reduced_database_violent %>% 
  filter(NAME == "Aurora, Colorado" & year >= 2020) %>% 
  select(property_crime_rate) %>% 
  pull()

mspe6 <- cvTools::mspe(est, real) / synth_aurora_property$loss.v
mspe6 <- mspe6[1]
l <- synth_aurora_property$loss.v
l <- l[1]
extremes <- which(placebos8$mspe.placs >= 5 * l) # l = Aurora loss.v value 
unit.names <- placebos8$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_aurora_lim <- test_results2 %>% 
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_aurora_lim)[1] <- "ratios"
n <- test_results_aurora_lim %>% 
  filter(ratios >= mspe6) %>% 
  nrow()
p6 <- n / nrow(test_results_aurora_lim)  # Find p-value again
p6
```

After performing placebo test analysis, we find that the MSPE ratio of Aurora is statistically significant at both the 10% and 5% levels after removing jurisdictions with pretreatment MSPEs more than 5x greater than that of Aurora. In particular, Aurora's MSPE ratio of `r round(mspe6, 3)` is surpassed by only Madison, WI and McAllen, TX. The data provides sufficient evidence to indicate that Aurora's 2020 and 2021 property crime rates were significantly greater than those of similar jurisdictions.

#### Visualizing the Placebos for Property Crime

Below, we created a histogram to visualize the placebos for property crime.

```{r summary-stats-placebos-3}
test_results2 %>% 
  summarise(mean = mean(MSPE.ratios), 
            sd = sd(MSPE.ratios), 
            median = median(MSPE.ratios)) %>% 
  kable(digits = 3)
```

```{r histogram-placebos-3}
test_results2 %>% 
  filter(unit != "Denver, Colorado") %>% 
ggplot(aes(x = MSPE.ratios)) + 
  geom_histogram(color = "black", binwidth = 0.5) +
  xlim(0, 40) +
  ylim(0, 20) + 
  geom_vline(xintercept = mspe6, color = "red") + 
  geom_vline(xintercept = mspe5, color = "steelblue") +
  geom_vline(xintercept = mspe4) + 
  labs(title = "Distribution of Placebo MSPE Ratios", 
       x = "MSPE Ratios", 
       y = "Count") 
```

Unlike the violent crime MSPE ratios, we did not have any extremely noticeable outliers. The standard deviation of the MSPE ratios for the placebos is much lower than the standard deviation of the MSPE ratios for the violent crime placebos even when removing outliers. This implies that the placebo MSPE ratios for property crimes may prove to be far more reliable, since there were not many excessively strong pretreatment fits coupled with significant deviations post-treatment time period.

As we can see on the histogram, both Denver and Aurora's MSPE ratios are extreme compared to the placebo synthetic controls, implying that the property crime increases in both jurisdictions likely did not result purely from chance. On the other hand, Colorado Springs' MSPE ratio is not extreme, existing roughly at the center of the distribution. The implications of this on the hypothesis that qualified immunity reform substantially increased property crime rates are mixed at best.

#### Sensitivity Testing: Displacing by Time

Another method to determine the significance of our results and the robustness of the model employed is to change the time of treatment. If changing the inputted treatment time also results in significant results when placebo testing, such a result may indicate that widely variable property crime rates in the treated jurisdictions from control models is nothing unusual. To test the robustness of our model, we tested the model by moving the treatment date to 2017. The post-treatment period was then designated as 2017-2019, and the pretreatment period was designated as 2011-2016. We generated 89 placebos and 3 treatment synthetic controls and calculated MSPE ratios to determine extremity for all 3 jurisdictions. If the model is robust at predicting that an unusual 2020 systematic causal factor is at play in Colorado, we would expect generally nonsignificant results in all 3 jurisdictions.

```{r}
reduced_database_violent2 <- reduced_database_violent %>% 
  filter(year <= 2019)

denver_property_prep2 <- dataprep(foo = reduced_database_violent2, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 24, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2017, time.optimize.ssr = 2011:2016, 
         time.plot = 2011:2019)

cspd_property_prep2 <- dataprep(foo = reduced_database_violent2, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                 "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 19, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2017, time.optimize.ssr = 2011:2016, 
         time.plot = 2011:2019)

aurora_property_prep2 <- dataprep(foo = reduced_database_violent2, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 4, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2017, time.optimize.ssr = 2011:2016, 
         time.plot = 2011:2019)

test_results3 <- mspe.test(placebos10)$test
test_results_denver_lim <- mspe.test(placebos10, discard.extreme = TRUE,
                                     mspe.limit = 5)$test
mspe7 <- test_results3 %>% 
  filter(unit == "Denver, Colorado") %>% 
  pull(MSPE.ratios)

test_results_denver_lim <- test_results_denver_lim %>% 
  filter(unit != "Denver, Colorado")

names(test_results_denver_lim)[1] <- "ratios"
n <- test_results_denver_lim %>% 
  filter(ratios >= mspe7) %>% 
  nrow()
p7 <- n / nrow(test_results_denver_lim)  # Find p-value again
p7


```
```{r cspd-time-placebo-values}
est <- cspd_property_prep2$Y0plot %*% synth_cspd_property2$solution.w
est <- est[c(7:9)]
real <- reduced_database_violent %>% 
  filter(NAME == "Colorado Springs, Colorado" & year >= 2017 & year <= 2019) %>% 
  select(property_crime_rate) %>% 
  pull()

mspe8 <- cvTools::mspe(est, real) / synth_cspd_property2$loss.v
mspe8 <- mspe8[1]
l <- synth_cspd_property2$loss.v
l <- l[1]
extremes <- which(placebos10$mspe.placs >= 5 * l) # l = CS loss.v value 
unit.names <- placebos10$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_aurora_lim <- test_results3 %>%  # 34 observations
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_aurora_lim)[1] <- "ratios"
n <- test_results_aurora_lim %>% 
  filter(ratios >= mspe8) %>% 
  nrow()
p8 <- n / nrow(test_results_aurora_lim)  # Find p-value again
p8

```
```{r aurora-time-placebo-values}
est <- aurora_property_prep2$Y0plot %*% synth_aurora_property2$solution.w
est <- est[c(7:9)]
real <- reduced_database_violent %>% 
  filter(NAME == "Aurora, Colorado" & year >= 2017 & year <= 2019) %>% 
  select(property_crime_rate) %>% 
  pull()

mspe9 <- cvTools::mspe(est, real) / synth_aurora_property2$loss.v
mspe9 <- mspe9[1]
l <- synth_aurora_property2$loss.v
l <- l[1]
extremes <- which(placebos10$mspe.placs >= 5 * l) # l = Aurora loss.v value 
unit.names <- placebos10$names.and.numbers$unit.names[extremes]
unit_names <- tibble(unit = unit.names) # Find unit names for those that qualify as extremes

test_results_aurora_lim <- test_results3 %>% 
  anti_join(unit_names) %>% 
  filter(unit != "Denver, Colorado")

names(test_results_aurora_lim)[1] <- "ratios" # 69 observations
n <- test_results_aurora_lim %>% 
  filter(ratios >= mspe9) %>% 
  nrow()
p9 <- n / nrow(test_results_aurora_lim)  # Find p-value again
p9
```


We visualized the placebo distributions below.


```{r summary-stats-placebos-10}
test_results3 %>% 
  summarise(mean = mean(MSPE.ratios), 
            sd = sd(MSPE.ratios), 
            median = median(MSPE.ratios)) %>% 
  kable(digits = 3)
```

```{r histogram-placebos-10}
test_results3 %>% 
  filter(unit != "Denver, Colorado") %>% 
ggplot(aes(x = MSPE.ratios)) + 
  geom_histogram(color = "black", binwidth = 1) +
  geom_vline(xintercept = mspe9, color = "red") + 
  geom_vline(xintercept = mspe8, color = "steelblue") +
  geom_vline(xintercept = mspe7) + 
  labs(title = "Distribution of Placebo MSPE Ratios", 
       x = "MSPE Ratios", 
       y = "Count") 
```

As the histogram demonstrates, the distribution of placebos is affected by a series of outliers above MSPE ratios of 20. This likely results from the fact that we have fewer pretreatment units which skews the pre-treatment MSPE towards lower numbers, creating the possibility for inflated MSPE ratios. This partially explains why Colorado Springs' MSPE ratio appears somewhat extreme; Colorado Springs had an exceptionally strong fit pretreatment before experiencing some deviation in both directions after the placebo treatment time of 2017.

```{r summary-table-by-time}
tab2 <- matrix(c(synth_denver_property$loss.v,
                synth_cspd_property$loss.v, synth_aurora_property$loss.v,
                synth_denver_property2$loss.v,
                synth_cspd_property2$loss.v, synth_aurora_property2$loss.v,
                mspe4, mspe5, mspe6, mspe7, mspe8, mspe9, p4, 
                p5, p6, p7, p8, p9), ncol = 3, byrow = FALSE)
colnames(tab2) <- c(" Pre-Treatment MSPE", "MSPE Ratio", "P-value")
rownames(tab2) <- c("Denver", "Colorado Springs", "Aurora", "Denver", 
                   "Colorado Springs", "Aurora")
kable(tab2, digits = 4)
```

The model stands up to the robustness check. The p-values are all nonsignificant, indicating that the MSPE ratios generated by a placebo treatment year are not extreme. 

#### Overall Property Crime Results

After constructing 89 different placebos and 3 synthetic controls for each of the treated jurisdictions, we found that Denver and Aurora both experienced property crime increases significantly greater than those of similar jurisdictions and that such increases likely did not result purely from chance (given that few placebos, outside of the one outlier, experienced similar increases). Such a finding will be discussed in further detail in the Discussion section. We additionally found that Colorado Springs' MSPE ratio was not extreme. Each of the synthetic controls fit their jurisdictions at least moderately well, with significant variation in how well the controls performed. Colorado Springs possessed the strongest synthetic control by far, while both Denver and Aurora's synthetic controls suffered from nonparallel trends. This may indicate that Colorado Springs' data provided the most reliable conclusions, a subject that will be expounded upon in further detail in the "Discussion" section.

### Summary Table 

```{r}
tab <- matrix(c(synth_denver_violent$loss.v, synth_cspd_violent$loss.v,
                synth_aurora_violent$loss.v, synth_denver_property$loss.v,
                synth_cspd_property$loss.v, synth_aurora_property$loss.v,
                mspe1, mspe2, mspe3, mspe4, mspe5, mspe6, p1, 
                p2, p3, p4, p5, p6), ncol = 3, byrow = FALSE)
colnames(tab) <- c(" Pre-Treatment MSPE", "MSPE Ratio", "P-value")
rownames(tab) <- c("Denver", "Colorado Springs", "Aurora", "Denver", 
                   "Colorado Springs", "Aurora")
kable(tab, digits = 4)
```

## Sensitivity Testing by Time



## Discussion

We found no statistically significant evidence in favor of the conclusion that Denver, Colorado Springs, or Aurora experienced unusually high violent crime rates after the passage of the police accountability bill in 2020 compared to control jurisdictions. On the other hand, we did find statistically significant evidence in favor of the conclusion that Denver and Aurora experienced unusually high property crime rates in 2020 and 2021 compared to placebo jurisdictions. In particular, Denver and Aurora's property crime rates increased in 2020 and 2021 to be far above the synthetic control, and their calculated MSPE ratios were unusualy even in the context of placebo synthetic controls, decreasing the ilkelihood that chance was the explanation for the property crime increase. Additionally, Colorado Springs' property crime rate was somewhat extreme, even if it was not significant in the placebo test. We now detail the implications of this analysis.

Several factors may cast doubt on the property crime findings that we have made here today. First, because both the Denver and Aurora synthetic controls were trending the opposite direction from the observed property crime rates, such synthetic controls are only expected to continue decreasing in 2020 and 2021. The fact that Denver and Aurora experienced large MSPE ratios may simply represent a flaw in the synthetic control itself, not a representation that Denver and Aurora possessed higher property crime rates than expected. Additionally, Colorado Springs, the jurisdiction with the strongest synthetic control, did not experience a statistically significant rise in property crime. 

We believe that this concern, although valid and important to consider, should not alone be enough to invalidate our Denver and Aurora findings. While synthetic Denver and Aurora did trend opposite from the observed cities, they still matched the predictors for both cities extremely well, and if we threw out every synthetic control merely because of non-ideal trending, many of the placebo synthetic controls likely would be removed as well. Standardizing MSPE ratios by dividing by pre-treatment MSPE to account for models that aren't well-fit should be able to compensate for some of the error. Additionally, the gaps between the synthetic jurisdictions and the observed jurisdictions were relatively moderate before 2020 and only expanded dramatically after 2020 and 2021. The synthetic controls, although weak, still imply that some causal factor is driving up property crime rates in Aurora and Denver that is not necessarily influencing other jurisdictions (or only influencing other jurisdictions to a lesser extent).

Second, the predictors we utilized were imperfect. As noted in Appendix 1, the predictors for violent crime only had an R-squared value of ____, while the predictors for proeprty crime only had an R-squared value of ____. These predictors, thus, were largely imperfect in explaining jurisdiction to jurisdiction variations in property and violent crime rates, and as a result, synthetic jurisdictions created on the basis of these predictors will be imperfect as well. Once again, this concern is valid but should not be enough to discredit the analysis. Especially for phenomenon that is as variable as crime rates, we must accept some imperfection in choosing the predictors to explain jurisdictional variations. Although data on certain predictors may improve the analysis (such as data on trust in police), the predictors that we have ensure that the synthetic controls will mimic the real jurisdictions in enough key socioeconomic indicators for the two to possess at least somewhat similar crime dynamics. 

We are confident in our ability to generate valid, albeit flawed, insights from the methodology that we used. However, we do not believe definitive causal conclusions can be generated from our report.

The data does suggest that some causal factor or combination of causal factors is uniquely affecting large urban jurisdictions in Colorado in a way that other control jurisdictions are not experiencing. The data also suggests that such a causal factor likely became prominent in 2020, at least in the cases of Denver and Aurora (Colorado Springs experienced an increase in 2019 that simply perpetuated into 2020 and 2021). However, because of the limitations of our synthetic control methodology, we cannot pinpoint the causal factors that explain such an increase. The problem is especially exacerbated given the random variations and unknowns that COVID-19 and the George Floyd protests presented. For instance, it is plausible that the Colorado state government's policy response to the COVID-19 pandemic was weaker than surrounding states, leading to higher unemployment and more property crimes. It is also plausible that the state simply experienced more property destructing during the protests compared to other states, leading to more reported property crimes. Even if we eventually gather the data needed to remove these "unknown" lurking variables, other confounding variables still hinder our ability to make an effective causal judgment. It is fully possible that the factors leading to the passage of the police accountability measure also led to increased property crime rates. For instance, citizens' attitudes towards police officers have been shown to significantly impact crime rates. When citizens distrust police officers, more violent and property crimes tend to occur due to a decrease in proactive policing. At the same time, citizen distrust could have also generated the political momentum to pass the qualified immunity legislation in the first place. With the presence of all these different plausible causal chains, using these insights to create a definitive claim on what causal factor caused increased property crime in large urban jurisdictions in Colorado would be both improper and invalid. For causal inference to be valid, we need more than just statistics; we require cotemporal factors to be controlled for and social scientific evidence that a causal chain is plausible. Unfortunately, this report only provides the statistics and is unable to control for cotemporal factors. 

Additionally, another key limitation on the ability for this report to contribute causal conclusions on qualified immunity reform is the bill itself. Although we centered this report on qualified immunity reform, in reality, Colorado's policing legislation passed in June of 2020 included a wealth of other reform measures, ranging from police transparency to general reform of police practices. We had no way of isolating qualified immunity reform from these other measures, and as a result, our conclusions only apply to the police accountability legislation. We hoped that the effects of the other parts of the legislation would be partially accounted for by the fact that most state jurisdictions passed some level of policing reform in the summer of 2020, likely including measures present in Colorado's bill except for qualified immunity reform. Thus, this effect may be coincidentally controlled for by the cotemporal passage of other police accountability legislation, but there is no guarantee that this will be the case, and we do not add a variable to check if police accountability legislation was passed in a particular jurisdiction or not. THus, our ability to attribute effects to qualified immunity reform, as opposed to other parts of the bill, is severely limited.

With these limitations in mind, what are our insights useful for? We believe that our insights can inform the public debate on qualified immunity and police accountability in two ways:

First, although the debate on police accountability usually centers on the effects of such bills on violent crime rates (such as murders and aggravated assaults), our report indicates that there is no significant evidence in favor of the idea that the qualified immunity legislation in Colorado coincided with a greater-than-expected increase in violent crime. In fact, especially in the cases of Denver and Colorado Springs, both jurisdictions experienced changes in violent crime that were relatively middle of the road compared to placebo jurisdictions. Although the lack of significance does *not* entail that there truly is no relationship between the two variables, we find it unlikely based on Denver and Colorado Springs' MSPE ratios that the Colorado police accountability measure increased violent crime rates in large jurisdictions. In terms of police accountability, our insights suggest that the true evidentiary debate should center on property crime rates.

Second, we can conclude that some unique causal factor increased property crime rates in Denver and Aurora. Our analysis rules out the idea that there is no surge in property crime rate in either jurisdiction; it also rules out chance as the explanation behind the increase. Whether the trends generalize to other cities in Colorado is debatable at best; we did not see the same level of significance in Colorado Springs even if we saw some extremity. However, at least in those two cities, we believe that our analysis reveals future directions for statistical and social scientific research in determining why those cities experienced such increases. 

## Appendix 1: Results from Removing Predictors

Using a combination of linear model selection procedures (such as forward selection and backward selection) and haphazard experimentation, we removed certain predictors from the analysis to improve the pre-treatment MSPE values. In particular, we removed median income and owner-occupied housing from violent crime analysis and removed owner-occupied housing and single female-led household precentage from property crime analysis. Below, we depicted a table comparing synthetic control diagnostics and results from both strategies. There was no real change in the significance of any of our results from removing these predictors.

```{r eval = FALSE}

tab <- matrix(c("Denver Violent Crime", "Colorado Springs Violent Crime", 
                   "Aurora Violent Crime", "Denver Property Crime", 
                   "Colorado Springs Property Crime", "Aurora Property Crime", 
                   "Denver Violent Crime", "Colorado Springs Violent Crime", 
                   "Aurora Violent Crime", "Denver Property Crime", 
                   "Colorado Springs Property Crime", "Aurora Property Crime",
                synth_denver_violent$loss.v, synth_cspd_violent$loss.v, 
                synth_aurora_violent$loss.v, synth_denver_property$loss.v,
                synth_cspd_property$loss.v, synth_aurora_property$loss.v, 
                synth_denver_violent2$loss.v, synth_cspd_violent2$loss.v, 
                synth_aurora_violent2$loss.v, synth_denver_property2$loss.v,
                synth_cspd_property2$loss.v, synth_aurora_property2$loss.v, 
                mspe1, mspe2, mspe3, mspe4, mspe5, mspe6, mspe7, mspe8, mspe9,
                mspe10, mspe11, mspe12, p1, p2, p3, p4, p5, p6, p7, p8, p9, 
                p10, p11, p12), ncol = 4, byrow = FALSE)

colnames(tab) <- c("Model Name", "Pre-Treatment MSPE", "MSPE Ratio", "P-Value")

tab <- as.data.frame(tab)
write_csv(tab, file = "data/table3.csv")
```

```{r}
tab3 <- read_csv("data/table3.csv")
kable(tab3, digits = 4, 
      caption = "Table 6: Comparing Results With and Without Predictors")
```

On average, in terms of pre-treatment MSPE, the models with excluded predictors tend to perform much better, the sole exception being Denver's Property Crime synthetic controls. However, we recognize that such an effect is inevitable given the nature of the synthetic control method. As the number of predictors deccreases, the model will generally have stronger and stronger pre-treatment MSPE values, simply because the model no longer has to choose jurisdictions with matching predictors to the observed jurisdiction and can focus purely on optimizing the pre-treatment fit. Thus, the decrease in pre-treatment MSPE, alone, cannot be justification for removing the predictors from the model. Additionally, the inclusion of predictors ensures that the synthetic model creates jurisdictions that match treated jurisdictions in meaningful predictors instead of simply choosing jurisdictions that, by chance, match the crime rates of treated jurisdictions prior to treatment. Although our analysis certainly could improve if we removed some of the predictors from our analysis (such as single female-led household percentage for property crimes or percentage of population who are over 18, which were generally found to be nonsignificant in our linear modeling), we decide to keep all predictors to ensure that our methodology remains standardized. 

Regardless, we include the above table to demonstrate that conclusions do not vary dramatically with the exclusion of certain unhelpful predictors, at least in the example provided.

## Appendix 2: Methodology B Results

Methodology B has the advantage of being precise about the treatment dates, allowing us to possibly isolate the qualified immunity bill as a factor, instead of other lurking variables such as COVID-19. However, we do not include the results in our main analysis due to critical methodological limitations that likely invalidate our results. Before we begin the discussion, please note that methodology B was mostly performed in the early stages of the report and has not been revised since then. Thus, synthetic control results and inclusion of jurisdictions were much different in methodology B compared to A.

### Violent Crime Synthetic Controls

Synthetic controls were different in several key ways: First, we included all jurisdictions above 50000 in population with data from all 9 years (2011-2019). Second, we incorporated single female-led household percentage as a predictor and simply used single female-led household percentage with children for 2019. Third, we did not include population density as a predictor. In total, we had around 500 jurisdictions in our synthetic control. Fourth, due to random errors in the optimization functions of the synthetic controls, we varied the pretreatment time periods to be 2011-2018 and 2011-2019, experimenting with both until one of the functions worked. Such a condition should be largely unimportant, as we do not use the synthetic control to directly match the crime rates, only to determine the series of jurisdictions that, when combined, comprise the majority weight of the synthetic control. Additionally, we optimized over 2014-2019. Below, we display the results for our violent crime synthetic controls.

```{r read-synth-b}
synth_denver_violent_b <- readRDS("data/denver_violent_synth.Rdata")
synth_denver_violent_b_limited <- readRDS("data/denver_violent_true.Rdata")
synth_denver_property_b <- readRDS("data/denver_property_synth.Rdata")
synth_denver_property_b_limited <- readRDS("data/denver_property_true.Rdata")
full_database <- read_csv("data/old_database.csv")
```

```{r full-database-wrangling}
reduced_database_b <- full_database %>% 
  select(1:20) %>% 
  filter(year <= 2019) %>%  # Remove all new data added afterwards to return to original synthetics
  filter(population >= 50000) %>%  
  filter(is.na(NAME) == FALSE)

for_removal <- reduced_database_b %>% 
  filter(NAME == "Burbank, California") %>%  # Remove duplicate names
  filter(white_percent < 40)

for_removal2 <- reduced_database_b %>% 
  filter(NAME == "Mesquite, Texas") %>% 
  filter(white_percent == 0.0)
for_removal <- full_join(for_removal, for_removal2)

for_removal2 <- reduced_database_b %>% 
  filter(NAME == "Mountain View, California") %>% 
  filter(white_percent > 48)
for_removal <- full_join(for_removal, for_removal2)

for_removal2 <- reduced_database_b %>% 
  filter(NAME == "Plantation, Florida") %>% 
  filter(white_percent > 90)
for_removal <- full_join(for_removal, for_removal2)

reduced_database_b <- anti_join(reduced_database_b, for_removal)
```

```{r create-reduced-violent-b}
reduced_database_violent_b <- reduced_database_b %>% 
  filter(is.na(violent_crime_rate) == FALSE & is.na(female_household) == FALSE &  # only exclude violent crime rate NAs
         is.na(hs) == FALSE & is.na(res_stability) == FALSE & is.na(over_18) == FALSE &  # no standardized database for both
         is.na(white_percent) == FALSE & is.na(self_employed) == FALSE & is.na(unemployment) == FALSE & 
         is.na(median_income) == FALSE & is.na(child_poverty) == FALSE & is.na(owner_occupied) == FALSE)
counts <- reduced_database_violent_b %>%  
  count(NAME, sort = TRUE)
remove_missing <- counts %>% 
  filter (n < 9)
reduced_database_violent_b <- anti_join(reduced_database_violent_b, remove_missing)

# add id numberes
add_numbers_violent <- reduced_database_violent_b %>% 
  filter(NAME == "Denver, Colorado" | NAME == "Colorado Springs, Colorado" |
           state != "Colorado") %>% 
  distinct(NAME) 

add_numbers_violent <- add_numbers_violent %>% 
  mutate(id = 1:nrow(add_numbers_violent))

reduced_database_violent_b <- full_join(reduced_database_violent_b, add_numbers_violent, by = "NAME")

# remove non-Denver Colorado
reduced_database_violent_b <- reduced_database_violent_b %>% 
  filter(NAME == "Denver, Colorado" | NAME == "Colorado Springs, Colorado" |
           state != "Colorado") %>% 
  mutate(id = as.numeric(id)) 
reduced_database_violent_b <- reduced_database_violent_b %>% 
  mutate(year = as.numeric(year)) 
reduced_database_violent_b <- as.data.frame(reduced_database_violent_b)
```



```{r}
denver_violent_prep_b <- dataprep(foo = reduced_database_violent_b, predictors = 
                                  c("population", "female_household", "owner_occupied",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income", 
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 186, controls.identifier = c(1:184, 187:514), 
         time.predictors.prior = 2011:2018, time.optimize.ssr = 2014:2019, 
         time.plot = 2011:2019)
```

```{r}
path.plot(synth.res = synth_denver_violent_b,
dataprep.res = denver_violent_prep_b,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

```{r}
tabs_b <- synth.tab(synth.res = synth_denver_violent_b, 
                    dataprep.res = denver_violent_prep_b)
tabs_b$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  slice(1:10) %>% 
  kable(digits = 3)
```

The synthetic control fits relatively well for the optimization time period with a pre-treatment MSPE of `r round(synth_denver_violent_b$loss.v, 3)`. Using the given weights, we took the 5 cities with the greatest weights and submitted FOIA requests to obtain access to their incident-level data (if the data was not already public) from 2019-2021. Our request to Ann Arbor was denied, leaving us with a total of 4 jurisdictions to use data for. We reran the synthetic control with just those 4 jurisdictions to determine the weights of the 4 jurisdictions for manual calculation of daily violent crime increases.

```{r}
denver_violent_prep_b_limited <- dataprep(foo = reduced_database_violent_b, predictors = c("population", "female_household", 
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income", 
                                                "child_poverty", "owner_occupied"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 186, controls.identifier = c(14, 266, 466, 496), 
         time.predictors.prior = 2011:2018, time.optimize.ssr = 2014:2019, 
         time.plot = 2011:2019)

path.plot(synth.res = synth_denver_violent_b_limited,
dataprep.res =denver_violent_prep_b_limited,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

```{r}
tabs_b <- synth.tab(synth.res = synth_denver_violent_b_limited, 
                    dataprep.res = denver_violent_prep_b_limited)
tabs_b$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  kable(digits = 3)
```

The plot demonstrates that the synthetic control of just the 4 jurisdictions match the violent crime trends in Denver relatively well. Once we obtained the weights, we did not need the synthetic control any longer. We used the above calculated weights and extrapolated the weights to 2020-2021 to manually calculate a synthetic control for daily violent crime increases using 2019-2021 incident level data.

### Property Crime Synthetic Controls

We performed the same method for property crime, except we changed the optimization to 2016-2019 to account for errors when we attempted to run 2014-2019 (and also to emphasize the more recent years to minimize MSPE values for the synthetic control). Because we are not calculating MSPE ratios, it is appropriate to decrease the pretreatment range to minimize MSPE values over, as an excessively small pre-treatment MSPE will not have disparate impacts on MSPE ratios as they would in a placebo analysis.

```{r}
reduced_database_property_b <- reduced_database_b %>% 
  filter(is.na(property_crime_rate) == FALSE & is.na(female_household) == FALSE &  # only exclude violent crime rate NAs
         is.na(hs) == FALSE & is.na(res_stability) == FALSE & is.na(over_18) == FALSE &  # no standardized database for both
         is.na(white_percent) == FALSE & is.na(self_employed) == FALSE & is.na(unemployment) == FALSE & 
         is.na(median_income) == FALSE & is.na(child_poverty) == FALSE & is.na(owner_occupied) == FALSE)
counts <- reduced_database_property_b %>%  
  count(NAME, sort = TRUE)
remove_missing <- counts %>% 
  filter (n < 9)
reduced_database_property_b <- anti_join(reduced_database_property_b, remove_missing)

# add id numbers
add_numbers_violent <- reduced_database_property_b %>% 
  filter(NAME == "Denver, Colorado" | NAME == "Colorado Springs, Colorado" |
           state != "Colorado") %>% 
  distinct(NAME) 

add_numbers_violent <- add_numbers_violent %>% 
  mutate(id = 1:nrow(add_numbers_violent))

reduced_database_property_b <- full_join(reduced_database_property_b, add_numbers_violent, by = "NAME")

# remove non-Denver Colorado
reduced_database_property_b <- reduced_database_property_b %>% 
  filter(NAME == "Denver, Colorado" | NAME == "Colorado Springs, Colorado" |
           state != "Colorado") %>% 
  mutate(id = as.numeric(id)) 
reduced_database_property_b <- reduced_database_property_b %>% 
  mutate(year = as.numeric(year)) 
reduced_database_property_b <- as.data.frame(reduced_database_property_b)
```

```{r}
denver_property_prep_b <- dataprep(foo = reduced_database_property_b, predictors = 
                                  c("population", "female_household", "owner_occupied",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income", 
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 186, controls.identifier = c(1:184, 187:531), 
         time.predictors.prior = 2011:2018, time.optimize.ssr = 2016:2019, # Changed optimization to correct for errors
         time.plot = 2011:2019)
```

```{r}
path.plot(synth.res = synth_denver_property_b,
dataprep.res = denver_property_prep_b,
Ylab = c("Property Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

```{r}
tabs_b <- synth.tab(synth.res = synth_denver_property_b, 
                    dataprep.res = denver_property_prep_b)
tabs_b$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  slice(1:10) %>% 
  kable(digits = 3)
```

As the path plot demonstrates, synthetic Denver does not follow observed Denver's trends very well, particularly before 2017. With a pre-treatment MSPE value of `r round(synth_denver_property_b$loss.v, 3)`, the synthetic control is not a good fit for the data. Nonetheless, we proceeded with the analysis. We once again took the 5 cities with the highest weights and recalculated the synthetic control. We were able to obtain data from all 5 jurisdictions.

```{r}
denver_property_prep_b_limited <- dataprep(foo = reduced_database_property_b, 
                                           predictors = c("population", "female_household", 
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "median_income", 
                                                "child_poverty", "owner_occupied"), 
         predictors.op = "mean", dependent = "property_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 186, controls.identifier = c(14, 266, 449, 466, 512), 
         time.predictors.prior = 2011:2018, time.optimize.ssr = 2014:2019, 
         time.plot = 2011:2019)

path.plot(synth.res = synth_denver_property_b_limited,
dataprep.res = denver_property_prep_b_limited,
Ylab = c("Property Crime Rates"),
Xlab = c("Year"),
Legend = c("Denver, CO","Synthetic Denver")
)
```

```{r}
tabs_b <- synth.tab(synth.res = synth_denver_property_b_limited, 
                    dataprep.res = denver_property_prep_b_limited)
tabs_b$tab.w %>% 
  arrange(desc(w.weights)) %>% 
  kable(digits = 3)
```

Because both Fort Smith and Houston had negligible weights, we used the incident level data from Austin, Champaign, and Seattle to run the simulation tests in the later section.


### Simulation and Significance Testing

### Statistical Bootstrapping Simulations

After collecting data from each of the 4-5 jurisdictions identified in each test as well as Denver and Colorado Springs, we calculated the daily differences in violent and property crime between the June 19, 2019 to June 18, 2020 time period compared to the June 19, 2020 to June 19, 2021 time period (the first time period also had an extra day from the leap year). In particular, we corresponded the dates so that the number of violent crimes on June 19, 2019 was subtracted from the number of violent crimes on June 19, 2020 and created a dataset of these differences in violent and property crime numbers. These differences were then divided by the total number of violent or property crimes in the first period of time. We divided by the total number of crimes in the previous period as opposed to the population in order to account for jurisdictions which began from already-high crime rates and the proportionately smaller increase in crime rate that the same absolute increase in crime would entail.

To calculate the synthetic control differences for comparison, we used the weights in the previous section and multiplied them by the proportional daily differences in crime between the two periods. We then summed up the the proportional daily differences and joined the two datasets together. We used bootstrapping to create a null distribution of 10000 differences in mean centered at 0 and determined if the probability of observing the difference between the mean proportional average daily increase in Denver or Colorado Springs with the mean proportional average daily increase in the synthetic control or greater was low enough to justify concluding that Denver or Colorado Springs' increase in violent crime was significantly greater than control jurisdictions.

#### Denver Violent Crime Tests

#### Denver Property Crime Tests

### Summary of Results

This methodology concludes similarly to the previous methodology we used. The data does not provide evidence at the 1% or 5% significance levels to indicate that Denver's increase in violent crime after the passage of police accountability legislation significantly exceeded the violent crime increase in control cities. However, the data does suggest that Denvers increase in property crime did exceed the property crime increase in similar cities without qualified immunity reform. Because of the critical limitations in our data and Methodology, these results do not meet the standard of statistical rigor needed to present this as definitive evidence that property crime rates truly did increase in Denver beyond what was expected. For instance, substantial problems existed in the way that we simulated to obtain results. By using daily differences between 2 different time periods, the standard deviation of such differences were exaggerated, as crimes can randomly increase or decrease day by day without reference to broader legislation. If there happened to be 20 violent crime incidents on June 19, 2020 and 0 violent crime incidents on June 19, 2019, the methodology would flag that day as a highly significant violent crime increase, even though the two days are not interconnected in any way. Additionally, our method of standardization gave smaller jurisdictions disproportionately more weight, as tiny variations in violent crime incidents were far more significant there. The graph below displays this phenomenon visually.

Nonetheless, we include the methodology here to demonstrate possible conclusions of an analysis that accurately referenced the treatment date and to provide additional corroboration of the main findings of our report.

## Appendix 3: Investigating Outliers

As noted in the "Results" section, the placebo synthetic controls for violent crime were significantly skewed by a series of high-MSPE ratio outliers, including 2 extreme outliers with MSPE ratios greater than 80. We investigate these outliers now.

#### Manchester, NH

```{r}
test_prep <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 56, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:55, 57:90, 
                                                            92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
         
```

```{r eval = FALSE}
synth_test <- synth(test_prep, optimxmethod = "All")

```

```{r eval = FALSE}
path.plot(synth.res = synth_test,
dataprep.res = test_prep,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Manchester, NH","Synthetic Manchester")
)
```

Manchester, NH had an MSPE ratio of over 200, more than 40x greater than the mean MSPE ratio without Manchester or Evansville. The path plot provides some insight into the mathematical reasons behind this occurrence. The synthetic control tracks the violent crime trends in Manchester exceptionally well until 2019; in 2020, the synthetic control experiences an increase in violent crime that is not matched by Manchester itself. Additionally, Manchester's violent crime rate in the first 3 quarters of 2021 are far lower than expected by the synthetic control. Although this is an outlier, further investigation does not reveal any clear data errors or differing circumstances that would warrant removing the Manchester data from the dataset. 

#### Evansville, Indiana

```{r}
test_prep2 <- dataprep(foo = reduced_database_violent, predictors = 
                                  c("population", "pop_density", "median_income",
                                                "hs", "res_stability", "over_18", 
                                                "white_percent", "self_employed", 
                                                "unemployment", "owner_occupied",
                                                "child_poverty"), 
         predictors.op = "mean", dependent = "violent_crime_rate", unit.variable = 
         "id", time.variable = "year", unit.names.variable = "NAME", 
         treatment.identifier = 30, controls.identifier = c(1:3, 5:8, 10:18, 20:23, 25:29, 
                                                            31:55, 57:90, 92:93), 
         time.predictors.prior = 2011:2020, time.optimize.ssr = 2012:2019, 
         time.plot = 2011:2021)
         
```

```{r eval = FALSE}
synth_test2 <- synth(test_prep2, optimxmethod = "All")

```

```{r eval = FALSE}
path.plot(synth.res = synth_test2,
dataprep.res = test_prep2,
Ylab = c("Violent Crime Rates"),
Xlab = c("Year"),
Legend = c("Evansville, IL","Synthetic Evansville")
)
```

Similarly, in Evansville, the synthetic control tracks the violent crime trends well until the treatment period begins, where Evansville experiences a sharp increase in violent crimes that is not followed by the synthetic control. Based on these graphs, we can make 2 plausible conclusion:

First, the synthetic control method appears to have trouble tracking abrupt shifts in violent crime rates, which may be attributable to the randomness by which violent crime rates increase or decrease. In Aurora's violent crime synthetic control, Aurora's abrupt increase in violent crime rates in 2016 was not well-tracked either, implying that although the synthetic control is effective at following trends over time, outlier years cannot be accurately followed with the predictors that we have. Similarly, in Evansville and Manchester, sharp increases and decreases in violent crime rates even without treatment could not be successfully tracked by the synthetic control.

Second, it is plausible that, even without treatment, large increases in violent crime rates could happen that simply happen to fall on the post-treatment years. This highlights the difficulty of making a causal claim; because there are many lurking variables, and violent crime rates are often very random phenomena, we cannot attribute large increases in crime rates purely to treatments. We can, however, use significance testing to diminish the likelihood that the years are explainable purely by chance, as we do in the analysis.

Whether these conclusions apply to property crime analysis is less certain, as the property crime placebos did not have many significant outliers. 


Second, the synthetic contorl method 

## Appendix 3: Sensitivity Testing Using time Placebos